<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos Integrales R&F</title>
    <!-- Favicon -->
    <link rel="icon" href="./images/favicon.jpg" type="image/png">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom Font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f8f8;
            color: #333;
        }
        /* Custom Colors */
        .text-primary { color: #228B22; /* Verde Bosque */ }
        .bg-primary { background-color: #228B22; }
        .hover-scale:hover { transform: scale(1.05); transition: transform 0.2s ease-in-out; }
        /* Barra de desplazamiento personalizada para una mejor estética */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Animaciones de aparición gradual */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        .animate-fade-in-delay {
            animation: fadeIn 1s ease-out forwards;
            animation-delay: 0.2s;
        }

        /* Estilos específicos del carrusel */
        .carousel-item {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: opacity 0.7s ease-in-out;
            opacity: 0;
            background-size: cover;
            background-position: center;
            display: flex; /* Siempre flex para el posicionamiento del contenido */
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 2rem;
            box-sizing: border-box;
        }
        .carousel-item.active {
            display: flex;
            opacity: 1;
        }
        .carousel-content {
            max-width: 800px;
            z-index: 10;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
        .carousel-control-btn {
            background-color: rgba(0,0,0,0.5);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 20;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            transition: background-color 0.3s;
        }
        .carousel-control-btn:hover {
            background-color: rgba(0,0,0,0.8);
        }
        .carousel-dots {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            display: flex;
            gap: 0.5rem;
        }
        .carousel-dot {
            width: 12px;
            height: 12px;
            background-color: rgba(255,255,255,0.5);
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .carousel-dot.active {
            background-color: rgba(255,255,255,1);
            transform: scale(1.2);
        }
    </style>

    <script>
        // Datos para productos - incluye descripciones en español
        // Se agregaron dateAdded y salesCount para la funcionalidad de 'Nuevos Productos' y 'Más Vendidos'
        // NUEVO: Se agregaron priceDetail y priceWholesale para precios basados en cantidad.
        const products = [
            {
                id: 'p1', name: 'Vitamina C Pura', brand: 'Alfa Vitamins®', category: 'Suplementos Naturales', subcategory: 'Vitaminas', type: 'Cápsulas', price: 850.00, priceDetail: 850.00, priceWholesale: 750.00,
                image: './images/product-vitamina-c-pura.jpg', // Ruta relativa para Vitamina C
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Suplemento de Vitamina C de alta pureza, esencial para fortalecer el sistema inmunológico y actuar como un potente antioxidante.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Ácido Ascórbico Puro, Cápsula Vegetal.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Tomar una cápsula diaria con una comida. Para necesidades específicas, consulte a un profesional de la salud.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>No exceder la dosis recomendada. Consultar a un médico antes de usar si está embarazada o lactando. Mantener fuera del alcance de los niños. Si está bajo medicación, consulte a su médico antes de usar. No utilizar si el sello de seguridad está roto o falta.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Detalles del Suplemento:</h5>
                    <p>La Vitamina C es un antioxidante vital para la salud general. Apoya la función inmune, la producción de colágeno, y ayuda en la absorción de hierro.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios Clave:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Potente antioxidante que combate los radicales libres.</li>
                        <li>Fortalece el sistema inmunológico, ayudando a prevenir resfriados y gripes.</li>
                        <li>Esencial para la síntesis de colágeno, mejorando la salud de la piel, huesos y articulaciones.</li>
                        <li>Mejora la absorción de hierro no hemo de fuentes vegetales.</li>
                        <li>Contribuye a la reducción del cansancio y la fatiga.</li>
                    </ul>
                `,
                certifications: ['Sin Gluten', 'Vegano'], benefits: ['Sistema Inmunológico', 'Antioxidante'], dateAdded: '2025-05-10', salesCount: 150, isOffer: true
            },
            {
                id: 'p2', name: 'Magnesio Glicinato', brand: 'BioEva', category: 'Suplementos Naturales', subcategory: 'Minerales y Oligoelementos', type: 'Cápsulas', price: 1200.00, priceDetail: 1200.00, priceWholesale: 1000.00,
                image: './images/product-magnesio-glicinato.jpg', // Ruta relativa para Magnesio Glicinato
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Forma altamente biodisponible de magnesio, ideal para la relajación muscular y el soporte del sistema nervioso.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Glicinato de Magnesio, Celulosa Microcristalina.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Tomar dos cápsulas al día con agua, preferiblemente 30 minutos antes de acostarse, o según las indicaciones de su profesional de la salud.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Mantener fuera del alcance de los niños. No exceder la dosis sugerida. Si experimenta alguna reacción adversa, suspenda su uso y consulte a un médico.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Sobre el Magnesio Glicinato:</h5>
                    <p>El Glicinato de Magnesio es una forma quelada de magnesio que se absorbe muy bien y es menos probable que cause efectos laxantes. Es ideal para quienes buscan apoyo para la relajación y el sueño.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios Clave:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Promueve la relajación muscular y alivia calambres.</li>
                        <li>Apoya la función saludable del sistema nervioso y reduce el estrés.</li>
                        <li>Contribuye a un sueño reparador y de mejor calidad.</li>
                        <li>Ayuda en la producción de energía y la función celular.</li>
                        <li>Beneficia la salud ósea y el ritmo cardíaco.</li>
                    </ul>
                `,
                certifications: ['Sin OGM'], benefits: ['Estrés/Ansiedad/Sueño', 'Sistema Nervioso'], dateAdded: '2025-06-01', salesCount: 220
            },
            {
                id: 'p3', name: 'Aceite de Coco Extra Virgen', brand: 'Organica RD', category: 'Alimentación Saludable', subcategory: 'Aceites y Condimentos', type: 'Aceite', price: 600.00, priceDetail: 600.00, priceWholesale: 500.00,
                image: './images/product-aceite-coco.jpg', // Ruta relativa para Aceite de Coco
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Aceite de coco 100% puro y orgánico, perfecto para cocinar, hornear o para el cuidado de la piel y el cabello.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Aceite de Coco Extra Virgen Orgánico.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Utilizar en la cocina como sustituto de otros aceites o aplicar directamente sobre la piel.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Almacenar en un lugar fresco y seco.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Sobre el Aceite de Coco:</h5>
                    <p>Nuestro Aceite de Coco Extra Virgen es prensado en frío, conservando todas sus propiedades y nutrientes. Es un superalimento versátil con múltiples usos.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Usos Culinarios:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Ideal para cocinar a altas temperaturas debido a su estabilidad.</li>
                        <li>Excelente en batidos, postres y como sustituto de la mantequilla.</li>
                        <li>Añade un delicioso sabor y aroma tropical a tus platos.</li>
                        <li>Puede utilizarse para rebozar alimentos antes de freír.</li>
                    </ul>
                    <h5 class="font-semibold text-md mt-4 mb-2">Usos Cosméticos:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Hidratante natural para piel y cabello.</li>
                        <li>Desmaquillante suave y efectivo.</li>
                        <li>Mascarilla capilar para nutrición profunda y brillo.</li>
                    </ul>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios para la Salud:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Fuente de triglicéridos de cadena media (MCTs) que proporcionan energía rápida.</li>
                        <li>Posee propiedades antimicrobianas y antifúngicas.</li>
                        <li>Apoya la salud del metabolismo y la digestión.</li>
                    </ul>
                `,
                certifications: ['Orgánico/Ecológico/Bio', 'Vegano'], benefits: ['Piel Saludable', 'Cocina Saludable'], dateAdded: '2025-04-20', salesCount: 350
            },
            {
                id: 'p4', name: 'Serum Facial con Vitamina C', brand: 'Såper', category: 'Cosmética Natural y Cuidado Personal', subcategory: 'Cuidado Facial', type: 'Serum', price: 1800.00, priceDetail: 1800.00, priceWholesale: 1600.00,
                image: './images/product-serum-facial-vc.jpg', // Ruta relativa para Serum Facial con Vitamina C
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Serum facial iluminador con alta concentración de Vitamina C, ideal para reducir manchas y mejorar la luminosidad de la piel.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Aqua, Glicerina, Ascorbyl Glucoside (Vitamina C), Extracto de Aloe Vera.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Aplicar 3-5 gotas sobre el rostro y cuello limpios, evitando el contorno de ojos. Usar por la mañana y/o noche, seguido de su crema hidratante.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Evitar el contacto directo con los ojos. Para mejores resultados, usar protector solar diariamente. Guardar en un lugar fresco y oscuro. Realizar una prueba de parche antes del primer uso si tiene piel sensible.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ficha Técnica del Producto:</h5>
                    <p>Este serum avanzado combina la potencia antioxidante de la Vitamina C estable con ingredientes hidratantes y calmantes para una piel radiante.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Componentes Clave:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Vitamina C (Ascorbyl Glucoside):</strong> Forma estable que ilumina, unifica el tono y protege contra el daño ambiental.</li>
                        <li><strong>Ácido Hialurónico:</strong> Proporciona hidratación profunda y rellena las líneas finas.</li>
                        <li><strong>Extracto de Aloe Vera:</strong> Calma y regenera la piel.</li>
                    </ul>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Reduce la apariencia de manchas oscuras y la hiperpigmentación.</li>
                        <li>Mejora la luminosidad y el resplandor natural de la piel.</li>
                        <li>Estimula la producción de colágeno para una piel más firme.</li>
                        <li>Protege contra los daños de los radicales libres y la contaminación.</li>
                    </ul>
                `,
                certifications: ['Cruelty-Free', 'Sin Parabenos'], benefits: ['Iluminador', 'Anti-edad'], dateAdded: '2025-06-15', salesCount: 90, isOffer: true
            },
            {
                id: 'p5', name: 'Colágeno Hidrolizado', brand: 'NutriWell', category: 'Suplementos Naturales', subcategory: 'Colágenos y Cartílagos', type: 'Polvo', price: 1500.00, priceDetail: 1500.00, priceWholesale: 1300.00,
                image: './images/product-colageno-hidrolizado.jpg', // Ruta relativa para Colágeno Hidrolizado
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Colágeno hidrolizado en polvo para mejorar la elasticidad de la piel, la salud de las articulaciones y fortalecer uñas y cabello.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Péptidos de Colágeno Hidrolizado.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Mezclar 1-2 cucharadas (aproximadamente 10-20g) en 200ml de agua, jugo, batido o bebida caliente. Consumir una vez al día, preferiblemente en ayunas o antes de dormir.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Consultar a un profesional de la salud antes de usar.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Información del Colágeno Hidrolizado:</h5>
                    <p>Nuestro colágeno hidrolizado es una proteína pura y de fácil digestión, esencial para mantener la estructura y elasticidad de los tejidos conectivos del cuerpo.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios Principales:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Piel:</strong> Mejora la elasticidad, firmeza e hidratación, reduciendo arrugas y líneas finas.</li>
                        <li><strong>Articulaciones y Huesos:</strong> Contribuye a la regeneración del cartílago, alivia el dolor articular y fortalece los huesos.</li>
                        <li><strong>Cabello y Uñas:</strong> Fortalece las uñas quebradizas y promueve el crecimiento y brillo del cabello.</li>
                        <li><strong>Digestión:</strong> Puede apoyar la salud del revestimiento intestinal.</li>
                    </ul>
                    <h5 class="font-semibold text-md mt-4 mb-2">Sugerencias de Uso:</h5>
                    <p>Ideal para deportistas, personas con desgaste articular, o aquellos que buscan mejorar la salud de su piel y anexos.</p>
                `,
                certifications: ['Sin Gluten'], benefits: ['Articulaciones', 'Piel Saludable'], dateAdded: '2025-05-25', salesCount: 400
            },
            {
                id: 'p6', name: 'Té de Manzanilla Orgánico', brand: 'Herbal Infusions', category: 'Alimentación Saludable', subcategory: 'Bebidas', type: 'Té', price: 350.00, priceDetail: 350.00, priceWholesale: 300.00,
                image: './images/product-te-manzanilla.jpg', // Ruta relativa para Té de Manzanilla
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Té de manzanilla orgánico, ideal para relajar y mejorar la digestión. Con propiedades antiinflamatorias naturales.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Flores de Manzanilla Orgánicas.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Infusionar una bolsita en agua caliente por 5 minutos. Se puede endulzar con miel o stevia.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Ninguna conocida. Ideal para personas que buscan una bebida natural para relajarse antes de dormir, aliviar molestias digestivas o como apoyo general para el bienestar.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Propiedades del Té de Manzanilla:</h5>
                    <p>La manzanilla es una de las hierbas más antiguas y versátiles, reconocida por sus propiedades calmantes y digestivas. Nuestro té es 100% orgánico, garantizando pureza.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios Tradicionales:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Ayuda a aliviar el estrés, la ansiedad y promueve la relajación.</li>
                        <li>Favorece la digestión, reduce la hinchazón y los gases.</li>
                        <li>Posee propiedades antiinflamatorias y antiespasmódicas.</li>
                        <li>Puede mejorar la calidad del sueño.</li>
                        <li>Aplicado tópicamente (compresas) puede calmar irritaciones de la piel.</li>
                    </ul>
                `,
                certifications: ['Orgánico/Ecológico/Bio'], benefits: ['Digestión', 'Estrés/Ansiedad/Sueño'], dateAdded: '2025-03-10', salesCount: 180, isOffer: true
            },
            {
                id: 'p7', name: 'Desodorante Natural Piedra Alumbre', brand: 'EcoFresh', category: 'Cosmética Natural y Cuidado Personal', subcategory: 'Cuidado Corporal', type: 'Desodorante', price: 400.00, priceDetail: 400.00, priceWholesale: 350.00,
                image: './images/product-desodorante-alumbre.jpg', // Ruta relativa para Desodorante Piedra Alumbre
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Desodorante natural hecho de piedra de alumbre, sin químicos ni sales de aluminio. Ofrece protección duradera.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Piedra de Alumbre Natural.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Humedecer ligeramente la piedra con agua limpia. Aplicar suavemente sobre la piel de las axilas recién limpias y secas. Asegurarse de cubrir toda el área. Dejar secar al aire antes de vestirse.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Sólo para uso externo. Evitar el contacto con heridas abiertas o piel irritada. Si observa alguna reacción, suspenda su uso.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Acerca de la Piedra de Alumbre:</h5>
                    <p>La piedra de alumbre es un mineral natural con propiedades astringentes y antibacterianas, ideal para un desodorante que respeta el equilibrio natural de la piel. No obstruye los poros.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ventajas:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Protección desodorante natural y duradera sin bloquear la transpiración.</li>
                        <li>Libre de clorhidrato de aluminio, parabenos, alcohol y fragancias sintéticas.</li>
                        <li>Hipoalergénico, ideal para pieles sensibles.</li>
                        <li>Económico y de larga duración.</li>
                        <li>No deja residuos blancos en la ropa.</li>
                    </ul>
                `,
                certifications: ['Sin Químicos', 'Sin Parabenos'], benefits: ['Cuidado Corporal'], dateAdded: '2025-06-10', salesCount: 80
            },
            {
                id: 'p8', name: 'Harina de Yuca Orgánica', brand: 'Cosecha RD', category: 'Alimentación Saludable', subcategory: 'Harinas', type: 'Harina', price: 250.00, priceDetail: 250.00, priceWholesale: 200.00,
                image: './images/product-harina-yuca.jpg', // Ruta relativa para Harina de Yuca
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Harina de yuca 100% orgánica, sin gluten, ideal para repostería y platos tradicionales.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Raíz de Yuca Orgánica.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Usar como sustituto de harinas convencionales en tus recetas favoritas. Ideal para espesar salsas y guisos. Excelente para preparar panes, galletas y postres sin gluten. Base para platos tradicionales como el casabe o moquecas. Puede utilizarse para rebozar alimentos antes de freír.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Almacenar en un lugar fresco y seco. Conservar en un recipiente hermético en un lugar fresco, seco y oscuro para preservar su frescura y evitar la humedad.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ficha Técnica de la Harina de Yuca:</h5>
                    <p>Nuestra harina de yuca orgánica es una alternativa natural y sin gluten, obtenida de la raíz de la yuca (mandioca). Es un ingrediente versátil para diversas preparaciones culinarias.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios Nutricionales:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Naturalmente libre de gluten, apta para celíacos y sensibles al gluten.</li>
                        <li>Buena fuente de carbohidratos complejos que proporcionan energía sostenida.</li>
                        <li>Contiene fibra dietética que favorece la digestión.</li>
                        <li>Fácil de digerir.</li>
                    </ul>
                `,
                certifications: ['Orgánico/Ecológico/Bio', 'Sin Gluten'], benefits: ['Cocina Saludable'], dateAdded: '2025-05-01', salesCount: 280
            },
            {
                id: 'p9', name: 'Mascarilla Capilar de Argán', brand: 'Pelo Sano', category: 'Cosmética Natural y Cuidado Personal', subcategory: 'Cuidado Capilar', type: 'Mascarilla', price: 900.00, priceDetail: 900.00, priceWholesale: 800.00,
                image: './images/product-mascarilla-argan.jpg', // Ruta relativa para Mascarilla de Argán
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción Detallada</h4>
                    <p>Mascarilla intensiva con aceite de argán para nutrir y reparar cabellos secos y dañados.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Completos:</h5>
                    <p>Aqua, Aceite de Argán, Glicerina, Manteca de Karité.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Modo de Uso Sugerido:</h5>
                    <p>Después de lavar el cabello con champú, eliminar el exceso de agua con una toalla. Aplicar una cantidad generosa de mascarilla de medios a puntas. Dejar actuar de 5 a 10 minutos. Para un tratamiento más profundo, cubrir con una toalla caliente. Enjuagar abundantemente.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Advertencias:</h5>
                    <p>Solo para uso externo. Evitar contacto con los ojos. Para un ritual completo, combinar con el champú y acondicionador de argán.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Descripción de la Mascarilla Capilar de Argán:</h5>
                    <p>Esta mascarilla ultra-nutritiva está enriquecida con puro aceite de argán, conocido como "oro líquido" por sus excepcionales propiedades reparadoras e hidratantes para el cabello.</p>
                    <h5 class="font-semibold text-md mt-4 mb-2">Ingredientes Activos Destacados:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Aceite de Argán:</strong> Rico en vitamina E y ácidos grasos esenciales, nutre profundamente y aporta brillo.</li>
                        <li><strong>Manteca de Karité:</strong> Hidrata intensamente, suaviza y protege el cabello.</li>
                        <li><strong>Proteínas de Trigo:</strong> Fortalecen la fibra capilar y reducen la rotura.</li>
                    </ul>
                    <h5 class="font-semibold text-md mt-4 mb-2">Beneficios para tu Cabello:</h5>
                    <ul class="list-disc list-inside ml-4">
                        <li>Reparación intensiva para cabellos secos, dañados y quebradizos.</li>
                        <li>Aporta hidratación, suavidad y un brillo deslumbrante.</li>
                        <li>Mejora la elasticidad y reduce el frizz.</li>
                        <li>Protege el cabello de agresiones externas.</li>
                    </ul>
                `,
                certifications: ['Cruelty-Free'], benefits: ['Cabello Sano'], dateAdded: '2025-06-05', salesCount: 110
            }
        ];

        // Datos de imágenes del carrusel
        const carouselImages = [
            {
                src: './images/carrusel1.jpg', // Ruta relativa para la imagen del carrusel 1
                alt_es: 'Descubre el Poder de lo Natural',
                title_es: 'Descubre el Poder de lo Natural',
                subtitle_es: 'Productos de alta calidad para tu bienestar y el de tu familia.',
                buttonText_es: 'Ver Tienda',
                buttonLink: '#shop'
            },
            {
                src: './images/carrusel2.jpg', // Ruta relativa para la imagen del carrusel 3
                alt_es: 'Ofertas Exclusivas',
                title_es: 'Ofertas Imperdibles',
                subtitle_es: 'Aprovecha nuestros descuentos especiales por tiempo limitado.',
                buttonText_es: 'Ver Ofertas',
                buttonLink: '#offers'
            },
            {
                src: './images/carrusel3.jpg', // Ruta relativa para la imagen del carrusel 2 (ahora estática)
                alt_es: 'Productos Frescos y Naturales',
                title_es: 'Tu Salud es Nuestra Prioridad',
                subtitle_es: 'Comprometidos con tu bienestar integral.',
                buttonText_es: null, // Sin botón para imagen estática
                buttonLink: null // Sin enlace para imagen estática
            }
        ];

        // Datos de productos combinados
        const combos = [
            {
                id: 'combo1',
                name_es: 'Combo Bienestar Total',
                src: './images/combo1.jpg',
                description_es: 'Un combo diseñado para potenciar tu salud general. Incluye productos esenciales para vitalidad y equilibrio diario.',
                products: [
                    'p1', // Vitamina C Pura
                    'p2', // Magnesio Glicinato
                    'p5', // Colágeno Hidrolizado
                    'p6', // Té de Manzanilla Orgánico
                    'p8'  // Harina de Yuca Orgánica
                ],
                price_es: 'Precio Especial: RD$3,500'
            },
            {
                id: 'combo2',
                name_es: 'Combo Belleza Natural',
                src: './images/combo2.jpg', 
                description_es: 'Descubre la belleza que viene de la naturaleza con este combo. Productos para el cuidado de piel y cabello.',
                products: [
                    'p4', // Serum Facial con Vitamina C
                    'p9', // Mascarilla Capilar de Argán
                    'p3', // Aceite de Coco Extra Virgen (para uso cosmético también)
                    'p7', // Desodorante Natural Piedra Alumbre
                    'p5'  // Colágeno Hidrolizado (beneficios para piel y cabello)
                ],
                price_es: 'Precio Especial: RD$2,900'
            }
        ];

        // Nuevo: Datos para Enfermedades y Soluciones
        const diseases = [
            {
                id: 'd1',
                name_es: 'Estrés y Ansiedad',
                image: './images/disease-stress-anxiety.jpg', // Imagen de marcador de posición para estrés/ansiedad
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción del Mal:</h4>
                    <p>El estrés y la ansiedad son respuestas naturales del cuerpo a las demandas de la vida. Sin embargo, cuando se vuelven crónicos, pueden manifestarse a través de síntomas físicos y emocionales como fatiga, irritabilidad, problemas de sueño, tensión muscular y dificultad para concentrarse.</p>
                    <h4 class="font-bold text-lg mt-4 mb-2">Posibles Soluciones Naturales y Productos Sugeridos:</h4>
                    <p>Los productos naturales pueden ofrecer un apoyo significativo para el manejo del estrés y la ansiedad, promoviendo la calma y el equilibrio interno:</p>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Magnesio Glicinato:</strong> Esencial para la función nerviosa y muscular. Ayuda a relajar el sistema nervioso y mejorar la calidad del sueño.</li>
                        <li><strong>Té de Manzanilla Orgánico:</strong> Conocido por sus propiedades sedantes y calmantes, ideal para reducir la tensión y promover un sueño reparador.</li>
                        <li><strong>Ashwagandha:</strong> Una hierba adaptógena que ayuda al cuerpo a adaptarse al estrés, mejorando la resistencia y reduciendo los niveles de cortisol.</li>
                        <li><strong>Valeriana:</strong> Utilizada tradicionalmente para aliviar el insomnio y la ansiedad debido a sus efectos sedantes suaves.</li>
                        <li><strong>Aceites Esenciales Relajantes:</strong> Como lavanda o bergamota, para aromaterapia que induce la relajación.</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">Recuerda consultar siempre a un profesional de la salud antes de iniciar cualquier nuevo suplemento o tratamiento natural, especialmente si tienes condiciones médicas preexistentes o estás tomando otros medicamentos.</p>
                `,
                relatedBenefits: ['Estrés/Ansiedad/Sueño', 'Sistema Nervioso'], // Enlace a productos por beneficio
                relatedProducts: ['p2', 'p6'] // IDs de productos directos
            },
            {
                id: 'd2',
                name_es: 'Salud Digestiva',
                image: './images/disease-digestive.jpg', // Imagen de marcador de posición para salud digestiva
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción del Mal:</h4>
                    <p>Una digestión saludable es fundamental para el bienestar general. Problemas digestivos comunes incluyen hinchazón, gases, estreñimiento, diarrea y acidez. Estos pueden ser causados por la dieta, el estrés, o desequilibrios en la flora intestinal.</p>
                    <h4 class="font-bold text-lg mt-4 mb-2">Posibles Soluciones Naturales y Productos Sugeridos:</h4>
                    <p>Apoyar el sistema digestivo con productos naturales puede mejorar significativamente la comodidad y la absorción de nutrientes:</p>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Harina de Yuca Orgánica:</strong> Una fuente de fibra prebiótica que alimenta la flora intestinal beneficiosa y puede ayudar a regular el tránsito.</li>
                        <li><strong>Aceite de Coco Extra Virgen:</strong> Contiene ácidos grasos de cadena media que tienen propiedades antimicrobianas y pueden apoyar la salud intestinal.</li>
                        <li><strong>Probióticos:</strong> Suplementos que introducen bacterias beneficiosas al intestino, ayudando a restaurar el equilibrio de la flora.</li>
                        <li><strong>Enzimas Digestivas:</strong> Ayudan a descomponer los alimentos para una mejor absorción de nutrientes y pueden reducir la hinchazón.</li>
                        <li><strong>Té de Jengibre:</strong> Conocido por sus propiedades carminativas que alivian los gases y la hinchazón.</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">Es importante mantener una dieta equilibrada, beber suficiente agua y consultar a un especialista si los síntomas persisten.</p>
                `,
                relatedBenefits: ['Digestión'],
                relatedProducts: ['p8', 'p3']
            },
            {
                id: 'd3',
                name_es: 'Salud Articular',
                image: './images/disease-joint-health.jpg', // Imagen de marcador de posición para salud articular
                description_es: `
                    <h4 class="font-bold text-lg mb-2">Descripción del Mal:</h4>
                    <p>Los problemas articulares pueden causar dolor, rigidez y limitar la movilidad. Factores como la edad, el desgaste, la inflamación o lesiones pueden afectar la salud de las articulaciones y los cartílagos.</p>
                    <h4 class="font-bold text-lg mt-4 mb-2">Posibles Soluciones Naturales y Productos Sugeridos:</h4>
                    <p>Existen diversos productos naturales que pueden contribuir a mantener la flexibilidad y reducir las molestias articulares:</p>
                    <ul class="list-disc list-inside ml-4">
                        <li><strong>Colágeno Hidrolizado:</strong> Es el componente principal del cartílago. Su suplementación puede ayudar a la regeneración de tejidos y reducir el dolor.</li>
                        <li><strong>Cúrcuma (Curcumina):</strong> Un potente antiinflamatorio natural que puede aliviar el dolor y la hinchazón en las articulaciones.</li>
                        <li><strong>Omega-3:</strong> Ácidos grasos esenciales con propiedades antiinflamatorias que benefician la salud articular y reducen la rigidez.</li>
                        <li><strong>Glucosamina y Condroitina:</strong> Componentes naturales del cartílago que apoyan su estructura y función.</li>
                        <li><strong>Boswellia Serrata:</strong> Otra hierba con fuertes propiedades antiinflamatorias que ayuda a la movilidad.</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600">Mantener un peso saludable y realizar ejercicio de bajo impacto son también cruciales para la salud articular.</p>
                `,
                relatedBenefits: ['Articulaciones'],
                relatedProducts: ['p5'] // Colágeno Hidrolizado
            }
            // Agregue más enfermedades según sea necesario
        ];

        // NUEVO: Datos para publicaciones del blog
        const blogPosts = [
            {
                id: 'blog1',
                title_es: 'Los Increíbles Beneficios del Magnesio para tu Salud',
                image: 'https://placehold.co/800x400/F0F8FF/000000?text=Beneficios+Magnesio',
                excerpt_es: 'Descubre por qué el magnesio es un mineral esencial y cómo puede mejorar tu sueño, reducir el estrés y más.',
                content_es: `
                    <h2 class="text-3xl font-bold text-primary mb-4">La Importancia del Magnesio en tu Cuerpo</h2>
                    <p class="mb-4">El magnesio es un mineral vital que participa en más de 300 reacciones bioquímicas en el cuerpo. Es crucial para el funcionamiento adecuado de músculos y nervios, la regulación de los niveles de azúcar en la sangre, la presión sanguínea, y la formación de proteínas, masa ósea y ADN.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Beneficios Clave del Magnesio:</h3>
                    <ul class="list-disc list-inside ml-6 mb-4">
                        <li><strong>Salud Ósea:</strong> Contribuye a la formación ósea y previene la osteoporosis.</li>
                        <li><strong>Función Muscular:</strong> Ayuda en la contracción y relajación muscular, aliviando calambres.</li>
                        <li><strong>Sistema Nervioso:</strong> Reduce el estrés, la ansiedad y mejora la calidad del sueño.</li>
                        <li><strong>Producción de Energía:</strong> Es esencial para la conversión de alimentos en energía.</li>
                        <li><strong>Salud Cardiovascular:</strong> Ayuda a mantener un ritmo cardíaco normal y la presión arterial.</li>
                    </ul>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">¿Cómo Obtener Suficiente Magnesio?</h3>
                    <p class="mb-4">Puedes encontrar magnesio en alimentos como vegetales de hoja verde (espinacas, kale), frutos secos (almendras, anacardos), semillas (chía, calabaza), legumbres, cereales integrales y chocolate negro. Sin embargo, debido al agotamiento del suelo y los hábitos alimenticios modernos, muchas personas no obtienen suficiente magnesio solo con la dieta.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Suplementación con Magnesio</h3>
                    <p class="mb-4">Si consideras la suplementación, el Glicinato de Magnesio es una de las formas más biodisponibles y menos propensas a causar efectos laxantes. Es ideal para aquellos que buscan apoyo para la relajación y el sueño.</p>
                    <p class="text-sm text-gray-600 mt-6">Recuerda siempre consultar a un profesional de la salud antes de iniciar cualquier suplemento.</p>
                `,
                date: '2025-06-20',
                author: 'Equipo R&F',
                tags: ['Magnesio', 'Suplementos', 'Salud']
            },
            {
                id: 'blog2',
                title_es: 'Guía Completa para una Rutina de Belleza Natural',
                image: 'https://placehold.co/800x400/F0F8FF/000000?text=Belleza+Natural',
                excerpt_es: 'Aprende a cuidar tu piel y cabello con productos naturales, paso a paso.',
                content_es: `
                    <h2 class="text-3xl font-bold text-primary mb-4">Despierta la Belleza que Hay en Ti con la Naturaleza</h2>
                    <p class="mb-4">Cada vez más personas se están volcando hacia la cosmética natural, y por una buena razón. Los productos naturales son a menudo más suaves con la piel, libres de químicos agresivos y, en muchos casos, más sostenibles. Aquí te presentamos una guía sencilla para construir tu rutina de belleza natural.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Paso 1: Limpieza Consciente</h3>
                    <p class="mb-4">Comienza tu rutina con una limpieza suave. Busca limpiadores faciales a base de aceites naturales (como el aceite de jojoba o almendras) o geles con extractos de plantas como el aloe vera.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Paso 2: Tonificación y Equilibrio</h3>
                    <p class="mb-4">Un buen tónico natural, como el agua de rosas o un hidrolato de lavanda, ayuda a equilibrar el pH de la piel y prepararla para los siguientes pasos. Rocía suavemente sobre el rostro limpio.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Paso 3: Nutrición con Sueros y Aceites</h3>
                    <p class="mb-4">Aquí es donde los ingredientes activos naturales brillan. Un <strong>Serum Facial con Vitamina C</strong> puede iluminar tu piel y reducir manchas. Para una hidratación profunda, los aceites faciales como el <strong>Aceite de Coco Extra Virgen</strong> o el aceite de argán son excelentes.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Paso 4: Hidratación Diaria</h3>
                    <p class="mb-4">Sella todos los beneficios con una crema hidratante natural. Busca ingredientes como la manteca de karité, la glicerina vegetal o el ácido hialurónico de origen natural.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Cuidado Capilar Natural</h3>
                    <p class="mb-4">Para tu cabello, opta por champús y acondicionadores sin sulfatos ni parabenos. Una vez a la semana, mima tu cabello con una <strong>Mascarilla Capilar de Argán</strong> para nutrirlo intensamente y devolverle el brillo.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Desodorantes Naturales</h3>
                    <p class="mb-4">Completa tu rutina con un desodorante que respete tu cuerpo, como el <strong>Desodorante Natural Piedra Alumbre</strong>, libre de químicos agresivos y aluminio.</p>
                    <p class="text-sm text-gray-600 mt-6">Adoptar una rutina de belleza natural es un viaje. Escucha a tu cuerpo y piel, y disfruta de los resultados que la naturaleza puede ofrecerte.</p>
                `,
                date: '2025-06-25',
                author: 'Equipo R&F',
                tags: ['Belleza', 'Cuidado Personal', 'Cosmética Natural']
            },
            {
                id: 'blog3',
                title_es: 'Alimentación Consciente: Cómo Empezar y Mantenerla',
                image: 'https://placehold.co/800x400/F0F8FF/000000?text=Alimentacion+Consciente',
                excerpt_es: 'Consejos prácticos para integrar una alimentación saludable y consciente en tu día a día.',
                content_es: `
                    <h2 class="text-3xl font-bold text-primary mb-4">Comiendo con Intención: Un Camino hacia el Bienestar</h2>
                    <p class="mb-4">La alimentación consciente, o "mindful eating", va más allá de lo que comemos; se trata de cómo comemos. Implica prestar atención a las sensaciones físicas, las emociones y los pensamientos que surgen antes, durante y después de comer.</p>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Principios Clave de la Alimentación Consciente:</h3>
                    <ul class="list-disc list-inside ml-6 mb-4">
                        <li><strong>Come Despacio:</strong> Tómate tu tiempo para masticar bien los alimentos y saborear cada bocado.</li>
                        <li><strong>Escucha a tu Cuerpo:</strong> Presta atención a las señales de hambre y saciedad. Come cuando tengas hambre real y detente cuando estés satisfecho, no cuando estés completamente lleno.</li>
                        <li><strong>Sin Distracciones:</strong> Evita comer frente a la televisión, el teléfono o el ordenador. Concéntrate en tu comida.</li>
                        <li><strong>Reconoce tus Emociones:</strong> ¿Comes por aburrimiento, estrés o tristeza? Aprende a identificar estos patrones.</li>
                        <li><strong>Aprecia tu Comida:</strong> Reflexiona sobre el origen de tus alimentos y el proceso que los llevó a tu plato.</li>
                    </ul>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Integrando Alimentos Naturales</h3>
                    <p class="mb-4">La alimentación consciente se complementa perfectamente con el consumo de alimentos naturales e integrales. Incorpora más:</p>
                    <ul class="list-disc list-inside ml-6 mb-4">
                        <li><strong>Frutas y Verduras:</strong> Son la base de una dieta saludable, ricas en vitaminas, minerales y fibra.</li>
                        <li><strong>Cereales Integrales:</strong> Como la <strong>Harina de Yuca Orgánica</strong>, proporcionan energía sostenida y fibra.</li>
                        <li><strong>Grasas Saludables:</strong> El <strong>Aceite de Coco Extra Virgen</strong> es una excelente fuente de MCTs.</li>
                        <li><strong>Bebidas Naturales:</strong> Infusiones como el <strong>Té de Manzanilla Orgánico</strong> pueden ayudar a la digestión y la relajación.</li>
                    </ul>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-3">Beneficios a Largo Plazo:</h3>
                    <p class="mb-4">Practicar la alimentación consciente puede llevar a una mejor digestión, un control de peso más saludable, una relación más positiva con la comida y una mayor sensación de bienestar general.</p>
                    <p class="text-sm text-gray-600 mt-6">Empieza hoy mismo con pequeños pasos. Cada comida es una oportunidad para nutrir tu cuerpo y mente de forma consciente.</p>
                `,
                date: '2025-06-18',
                author: 'Equipo "Productos Integrales R&F"',
                tags: ['Alimentación', 'Bienestar', 'Nutrición']
            }
        ];


        // Objeto de traducciones para soporte multilingüe (solo español)
        const translations = {
            es: {
                promoBanner: "Envío GRATIS por el consumo mínimo de RD$2,000 | Entrega en 24/48 horas | Confianza y pago seguro",
                searchPlaceholder: "Buscar productos...",
                myAccount: "Mi Cuenta", login: "Iniciar Sesión", register: "Registrarse",
                home: "Inicio", shop: "Tienda", offers: "Ofertas", diseasesSolutions: "Enfermedades y Soluciones",
                filterBy: "Filtrar por", brand: "Marca", productType: "Tipo de Producto", skinHairType: "Tipo de Piel / Cabello",
                healthBenefit: "Beneficio / Condición de Salud", certifications: "Certificaciones", price: "Precio", availability: "Disponibilidad",
                inStock: "En stock", outOfStock: "No disponible", sortBy: "Ordenar por", relevance: "Relevancia",
                priceAsc: "Precio (Ascendente)", priceDesc: "Precio (Descendente)", mostSold: "Más vendidos", newest: "Novedades",
                customerRating: "Calificación de clientes", addToCart: "Añadir al Carrito", all: "Todos", applyFilters: "Aplicar Filtros",
                description: "Descripción Detallada", reviews: "Opiniones y Calificaciones", relatedProducts: "Productos Relacionados",
                yourCart: "Tu Carrito de Compras", item: "Artículo", quantity: "Cantidad", subtotal: "Subtotal:", discount: "Descuento:", shippingCost: "Envío:", total: "Total a pagar:",
                checkout: "Realizar Pedido", continueShopping: "Continuar Comprando", cartEmpty: "Tu carrito está vacío.", removeItem: "Eliminar",
                productAdded: "Producto Añadido al Carrito", addedSuccessfully: "¡El producto ha sido añadido exitosamente a tu carrito de compras!", close: "Cerrar",
                // Pie de página y nuevas páginas
                customerServiceTitle: "Atención al Cliente", aboutUs: "Sobre Nosotros", contact: "Contacto", blog: "Blog", paymentMethods: "Métodos de Pago",
                followUs: "Síguenos", newsletter: "Newsletter", yourEmail: "Tu correo electrónico", subscribe: "Suscribir",
                copyright: "&copy; 2025 R&F Productos Integrales. Todos los derechos reservados.",
                disclaimer: "Descargo de Responsabilidad: La información en este sitio no reemplaza el consejo médico. Los productos no están destinados a diagnosticar, tratar, curar o prevenir enfermedades. Consultar a un médico para dosis y frecuencia.",
                // Nuevas traducciones para los detalles de contacto del cliente y el proceso de compra
                contactDetails: "Tus Datos de Contacto",
                fullName: "Nombre Completo",
                yourNamePlaceholder: "Tu Nombre",
                deliveryAddress: "Dirección de Entrega",
                yourAddressPlaceholder: "Calle, número, sector, ciudad",
                yourPhoneNumber: "Tu Teléfono (WhatsApp)",
                yourPhonePlaceholder: "Ej: 8091234567",
                requiredFields: "Campos Requeridos",
                completeYourDetails: "Por favor, completa todos tus datos de contacto (Nombre, Dirección, Teléfono) y selecciona el Método de Entrega y Pago para poder procesar tu pedido.",
                orderSent: "Pedido Enviado",
                orderSentMessage: "Tu pedido ha sido enviado por WhatsApp. ¡Nos pondremos en contacto contigo pronto!",
                deliveryMethod: "Método de Entrega",
                homeDelivery: "A Domicilio",
                storePickup: "Recoger en Tienda",
                deliveryCostNoteSantoDomingo: "Si el envío es en el Gran Santo Domingo o DN., el costo será de RD$400.00",
                deliveryCostNoteOutside: "Si el envío es fuera de esta área demográfica (otras partes del país), el costo será de RD$600.00",
                paymentMethod: "Método de Pago",
                cash: "Efectivo",
                bankTransfer: "Transferencia Bancaria",
                selectDelivery: "Selecciona un método de entrega",
                selectPayment: "Selecciona un método de pago",
                bankAccounts: "Cuentas Bancarias para Transferencia",
                bankPopular: "Banco Popular: 123456789 (Cuenta de ahorro - Troadia Cepeda)",
                banreservas: "Banreservas: 123456789 (Cuenta Corriente - Fausto Paulino Cepada)",
                bhd: "BHD: 123456789 (Cuenta de ahorro - Fausto Paulino Cepada)",
                paymentConfirmationNote: "Para pagos vía transferencia, haga el pago cuando su pedido ha sido confirmado por uno de nuestros representantes.",
                discountNote: "La aplicación de algún descuento especial, si el caso lo amerita, será realizado por el representante, una vez reciba la notificación del pedido, y se lo comunicará al cliente inmediatamente revise la solicitud del pedido y antes de proceder con el pago.",
                aboutUsPageTitle: "Nuestra Historia en R&F Productos Integrales",
                aboutUsPageContent: "En R&F Productos Integrales, nuestra pasión es tu bienestar. Fundada en 2025, nos dedicamos a seleccionar y ofrecer los más puros y efectivos productos naturales de la República Dominicana. Creemos firmemente en el poder de la naturaleza para nutrir el cuerpo y la mente, y nuestro compromiso es brindarte opciones saludables y sostenibles. Cada producto en nuestra tienda ha sido cuidadosamente elegido, garantizando calidad, origen y eficacia. Únete a nuestra comunidad y descubre un mundo de bienestar natural.",
                commonDiseases: "Enfermedades Más Comunes",
                diseasePrevention: "Prevención de Enfermedades", // Agregado para la sección de enfermedades de la página de inicio
                stressAnxietySleep: "Estrés, Ansiedad y Sueño", // Agregado para la sección de enfermedades de la página de inicio
                commentsRatings: "Comentarios y Valoraciones",
                comboSpecial: "Combo Especial",
                viewDetails: "Ver Detalles",
                homePageNewProducts: "Nuevos Productos",
                contactPageTitle: "Contáctanos",
                contactPageIntro: "Estamos aquí para ayudarte. Si tienes preguntas, comentarios o necesitas asistencia, no dudes en contactarnos.",
                phoneLabel: "Escríbenos:", // ¡Cambiado de Teléfono!
                emailLabel: "Correo Electrónico:", // Actualizado en la siguiente versión del código
                websiteLabel: "Página Web:", // Nueva traducción
                addressLabel: "Dirección:",
                hoursLabel: "Horario de Atención:",
                hours: "Lunes a Viernes: 9 AM - 5 PM", // Horas específicas
                ourBlogTitle: "Nuestro Blog",
                blogIntro: "Explora nuestros artículos sobre salud, bienestar y productos naturales.",
                paymentMethodsPageTitle: "Métodos de Pago",
                paymentMethodsIntro: "Ofrecemos diversas opciones de pago para tu conveniencia.",
                loginPageTitle: "Iniciar Sesión",
                loginIntro: "Accede a tu cuenta para una experiencia de compra personalizada.",
                registerPageTitle: "Registrarse",
                registerIntro: "Crea una cuenta nueva para disfrutar de todos los beneficios de R&F Productos Integrales.",
                myAccountPageTitle: "Mi Cuenta",
                myAccountIntro: "Bienvenido a tu panel de control. Aquí puedes gestionar tus pedidos, direcciones y detalles de cuenta.",
                namePlaceholder: "Nombre",
                emailPlaceholder: "Correo Electrónico",
                passwordPlaceholder: "Contraseña",
                confirmPasswordPlaceholder: "Confirmar Contraseña",
                loginButton: "Iniciar Sesión",
                registerButton: "Registrarse",
                forgotPassword: "¿Olvidaste tu contraseña?",
                alreadyHaveAccount: "¿Ya tienes una cuenta?",
                dontHaveAccount: "¿No tienes una cuenta?",
                viewProducts: "Ver Productos",
                // Nuevas traducciones para páginas de enfermedades y combos
                diseaseDescription: "Descripción del Mal",
                naturalSolutions: "Soluciones Naturales y Productos Sugeridos",
                productsForThis: "Productos para esta condición",
                comboContents: "Contenido del Combo",
                goToProduct: "Ir al Producto"
            }
        };

        let currentLanguage = 'es'; // Idioma por defecto

        // Inicializar el carrito desde localStorage o como un array vacío
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        // Determinar la página inicial desde el hash de la URL o por defecto a 'home'
        let currentPage = window.location.hash.substring(1).split('-')[0] || 'home';

        // Variables para los elementos del DOM (se inicializarán en DOMContentLoaded)
        let appContent;
        let cartCountElement;
        let cartModal;
        let searchInput;

        // --- Funciones de ayuda ---

        /**
         * Formatea un número como una cadena de moneda de pesos dominicanos (RD$).
         * @param {number} price - El precio a formatear.
         * @returns {string} La cadena de precio formateada.
         */
        const formatPrice = (price) => `RD$${price.toFixed(2)}`;

        /**
         * Actualiza el contador de elementos del carrito mostrado en el encabezado.
         */
        const updateCartCount = () => {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            if (cartCountElement) { // Añadir comprobación
                cartCountElement.textContent = totalItems;
            }
        };

        /**
         * Muestra un modal con un título y mensaje dados.
         * @param {string} title - El título para el modal.
         * @param {string} message - El contenido del mensaje para el modal.
         */
        const showModal = (title, message) => {
            if (document.getElementById('modal-title')) { // Añadir comprobación
                document.getElementById('modal-title').textContent = title;
            }
            if (document.getElementById('modal-message')) { // Añadir comprobación
                document.getElementById('modal-message').textContent = message;
            }
            if (cartModal) { // Añadir comprobación
                cartModal.classList.remove('hidden');
            }
        };

        /**
         * Oculta el modal actualmente activo.
         */
        const closeModal = () => {
            if (cartModal) { // Añadir comprobación
                cartModal.classList.add('hidden');
            }
        };

        /**
         * Guarda el estado actual del carrito en localStorage.
         */
        const saveCart = () => {
            localStorage.setItem('cart', JSON.stringify(cart));
        };

        /**
         * Extrae categorías principales únicas de los datos de productos.
         * @returns {string[]} Un array de nombres de categorías únicas.
         */
        const getUniqueCategories = () => {
            const categories = new Set();
            products.forEach(p => categories.add(p.category));
            return Array.from(categories);
        };

        /**
         * Extrae subcategorías únicas para una categoría principal dada.
         * @param {string} category - La categoría principal por la que filtrar.
         * @returns {string[]} Un array de nombres de subcategorías únicas.
         */
        const getUniqueSubcategories = (category) => {
            const subcategories = new Set();
            products.filter(p => p.category === category).forEach(p => subcategories.add(p.subcategory));
            return Array.from(subcategories);
        };

        /**
         * Extrae nombres de marcas únicas de los datos de productos.
         * @returns {string[]} Un array de nombres de marcas únicas.
         */
        const getUniqueBrands = () => {
            const brands = new Set();
            products.forEach(p => brands.add(p.brand));
            return Array.from(brands);
        };

        /**
         * Extrae nombres de certificaciones únicas de los datos de productos.
         * @returns {string[]} Un array de nombres de certificaciones únicas.
         */
        const getUniqueCertifications = () => {
            const certs = new Set();
            products.forEach(p => {
                p.certifications.forEach(cert => certs.add(cert));
            });
            return Array.from(certs);
        };

        /**
         * Extrae beneficios de salud únicos de los datos de productos.
         * @returns {string[]} Un array de nombres de beneficios únicas.
         */
        const getUniqueBenefits = () => {
            const benefits = new Set();
            products.forEach(p => {
                p.benefits.forEach(benefit => benefits.add(benefit));
            });
            return Array.from(benefits);
        };


        // --- Gestión de Idioma (solo español) ---

        /**
         * Actualiza todos los elementos de texto traducibles en la página según el currentLanguage.
         */
        const updateContentLanguage = () => {
            const lang = translations[currentLanguage];

            // Actualizar elementos con atributo data-translate
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (lang[key]) {
                    if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
                        element.placeholder = lang[key];
                    } else {
                        element.textContent = lang[key];
                    }
                }
            });

            // Actualizaciones específicas para elementos que combinan texto e íconos o tienen estructuras complejas
            const promoBannerElement = document.getElementById('promo-banner');
            if (promoBannerElement) { // Añadir comprobación
                promoBannerElement.textContent = lang.promoBanner;
            }
            const shopLink = document.querySelector('.group > a[href="#shop"]');
            if (shopLink && shopLink.childNodes[0]) { // Añadir comprobación
                 shopLink.childNodes[0].nodeValue = lang.shop + ' '; // Para preservar el ícono
            }
            
            // Actualizar el elemento del teléfono en el encabezado si existe
            const headerPhoneElement = document.querySelector('header .md\\:flex.items-center.space-x-2.ml-4 a');
            if (headerPhoneElement) {
                headerPhoneElement.textContent = `${lang.phoneLabel} 809-425-4540`;
            }

            // Volver a poblar el menú de categorías para consistencia de idioma
            populateCategoryMenu();

            // Volver a renderizar el contenido del carrusel para reflejar los cambios de idioma
            if (currentPage === 'home' && appContent) { // Añadir comprobación
                renderHome(); // Vuelve a renderizar la página de inicio, que incluye el carrusel
            }
        };


        // --- Funciones de renderizado para páginas ---

        /**
         * Renderiza el contenido de la página de inicio, incluyendo el carrusel.
         */
        const renderHome = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="relative h-[250px] md:h-[350px] lg:h-[450px] w-full overflow-hidden rounded-lg shadow-lg mb-12">
                    <div id="hero-carousel" class="absolute inset-0">
                        ${carouselImages.map((item, index) => `
                            <div class="carousel-item ${index === 0 ? 'active' : ''}" style="background-image: url('${item.src}');">
                                <div class="carousel-content bg-black bg-opacity-40 p-6 rounded-lg mx-4">
                                    <h1 class="text-3xl md:text-5xl font-extrabold mb-2 animate-fade-in">${item[`title_${currentLanguage}`]}</h1>
                                    <p class="text-lg md:text-xl mb-6 opacity-90 animate-fade-in-delay">${item[`subtitle_${currentLanguage}`]}</p>
                                    ${item.buttonLink ? `
                                    <a href="${item.buttonLink}" onclick="navigateTo('${item.buttonLink.substring(1)}', null, event)" class="bg-white text-primary px-6 py-3 rounded-full text-md md:text-lg font-semibold hover:bg-green-100 hover-scale transition duration-300 shadow-md">
                                        ${item[`buttonText_${currentLanguage}`]}
                                    </a>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <!-- Controles del carrusel -->
                    <button class="carousel-control-btn left-4" onclick="changeSlide(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="carousel-control-btn right-4" onclick="changeSlide(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <!-- Puntos del carrusel -->
                    <div class="carousel-dots">
                        ${carouselImages.map((_, index) => `
                            <span class="carousel-dot ${index === 0 ? 'active' : ''}" onclick="currentSlide(${index})"></span>
                        `).join('')}
                    </div>
                </section>

                <section class="new-products mb-12">
                    <h2 class="text-3xl font-bold text-center mb-8 text-primary">${lang.homePageNewProducts}</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                        ${products.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded)).slice(0, 4).map(p => `
                            <div class="bg-white rounded-lg shadow-md p-6 text-center hover-scale flex flex-col justify-between">
                                <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)">
                                    <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/D3D3D3/000000?text=Imagen+No+Disp';" class="w-full h-48 object-contain mb-4 mx-auto rounded-md">
                                </a>
                                <h3 class="text-lg font-semibold text-gray-800 mb-2">${p.name}</h3>
                                <p class="text-gray-600 text-sm mb-4">${p.brand}</p>
                                <p class="text-xl font-bold text-primary mb-4">${formatPrice(p.priceDetail)}</p>
                                <button onclick="addToCart('${p.id}')" class="bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">
                                    ${lang.addToCart}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </section>

                <section class="common-diseases mb-12">
                    <h2 class="text-3xl font-bold text-center mb-8 text-primary">${lang.commonDiseases}</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${diseases.map(d => `
                            <a href="#disease-${d.id}" onclick="navigateTo('disease', '${d.id}', event)" class="block bg-white rounded-lg shadow-md p-6 text-center hover-scale flex flex-col items-center justify-center">
                                <img src="${d.image}" alt="${d[`name_es`]}" onerror="this.onerror=null;this.src='https://placehold.co/300x200/D3D3D3/000000?text=Enfermedad';" class="w-full h-48 object-cover mb-4 rounded-md">
                                <h3 class="text-2xl font-semibold text-gray-800 mb-2">${d[`name_es`]}</h3>
                                <p class="text-gray-600">${lang.viewDetails}</p>
                            </a>
                        `).join('')}
                    </div>
                </section>

                <section id="comments-ratings-section" class="comments-ratings mb-12 bg-gray-100 rounded-lg p-8 shadow-inner">
                    <h2 class="text-3xl font-bold text-center mb-8 text-primary">${lang.commentsRatings}</h2>
                    <div class="space-y-6">
                        <!-- Comentario de ejemplo 1 -->
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <div class="flex items-center mb-2">
                                <div class="text-yellow-500">
                                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="ml-2 text-gray-600 font-semibold">Ana P.</span>
                            </div>
                            <p class="text-gray-700 leading-relaxed">"¡Estoy fascinada con los productos de R&F! El aceite de coco es increíble, lo uso para todo. Y la atención al cliente es de primera. ¡Recomendadísimos!"</p>
                        </div>
                        <!-- Comentario de ejemplo 2 -->
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <div class="flex items-center mb-2">
                                <div class="text-yellow-500">
                                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
                                </div>
                                <span class="ml-2 text-gray-600 font-semibold">Carlos R.</span>
                            </div>
                            <p class="text-gray-700 leading-relaxed">"Compré la Vitamina C Pura y he sentido una mejora notable en mi energía. La entrega fue rápida y el empaque muy cuidadoso. Gracias por estos productos naturales de calidad."</p>
                        </div>
                        <!-- Comentario de ejemplo 3 -->
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <div class="flex items-center mb-2">
                                <div class="text-yellow-500">
                                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                                </div>
                                <span class="ml-2 text-gray-600 font-semibold">Sofía M.</span>
                            </div>
                            <p class="text-gray-700 leading-relaxed">"Excelente servicio y productos! La mascarilla de argán dejó mi cabello increíble. Definitivamente seguiré comprando aquí."</p>
                        </div>
                    </div>
                    <div class="text-center mt-8">
                        <button onclick="document.getElementById('comments-ratings-section').scrollIntoView({ behavior: 'smooth' });" class="bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">Ver Más Comentarios</button>
                    </div>
                </section>

                <section class="about-us-mini bg-gray-100 rounded-lg p-8 text-center shadow-inner">
                    <h2 class="text-3xl font-bold mb-4 text-primary">${lang.aboutUsPageTitle}</h2>
                    <p class="text-gray-700 text-lg leading-relaxed">${lang.aboutUsPageContent}</p>
                    <a href="#about-us" onclick="navigateTo('about-us', null, event)" class="text-primary hover:underline mt-4 inline-block font-semibold">Leer más</a>
                </section>
            `;
            initCarousel(); // Inicializar el carrusel después de renderizar
        };

        let slideIndex = 0;
        let carouselInterval;

        /**
         * Inicializa el carrusel mostrando la primera diapositiva e iniciando la reproducción automática.
         */
        const initCarousel = () => {
            showSlides(slideIndex);
            clearInterval(carouselInterval); // Limpiar cualquier intervalo existente
            carouselInterval = setInterval(() => {
                changeSlide(1);
            }, 5000); // Cambiar diapositiva cada 5 segundos
        };

        /**
         * Muestra una diapositiva específica en el carrusel.
         * @param {number} n - El índice de la diapositiva a mostrar.
         */
        const showSlides = (n) => {
            const slides = document.getElementsByClassName("carousel-item");
            const dots = document.getElementsByClassName("carousel-dot");
            if (slides.length === 0) return;

            if (n >= slides.length) { slideIndex = 0 }
            if (n < 0) { slideIndex = slides.length - 1 }

            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove('active');
            }
            for (let i = 0; i < dots.length; i++) {
                dots[i].classList.remove('active');
            }
            slides[slideIndex].classList.add('active');
            dots[slideIndex].classList.add('active');
        };

        /**
         * Cambia la diapositiva actual en un paso dado.
         * @param {number} n - El paso para cambiar la diapositiva (ej., 1 para siguiente, -1 para anterior).
         */
        const changeSlide = (n) => {
            showSlides(slideIndex += n);
            clearInterval(carouselInterval); // Reiniciar temporizador de reproducción automática en navegación manual
            carouselInterval = setInterval(() => {
                changeSlide(1);
            }, 5000);
        };

        /**
         * Navega directamente a una diapositiva específica.
         * @param {number} n - El índice de la diapositiva a la que navegar.
         */
        const currentSlide = (n) => {
            showSlides(slideIndex = n);
            clearInterval(carouselInterval); // Reiniciar temporizador de reproducción automática en navegación manual
            carouselInterval = setInterval(() => {
                changeSlide(1);
            }, 5000);
        };


        /**
         * Renderiza la página de la tienda con opciones de filtro y clasificación.
         * @param {Object} filter - Un objeto que contiene los criterios de filtro actuales.
         * @param {string} sort - El orden de clasificación actual (ej., 'relevance', 'priceAsc', 'new', 'bestsellers').
         */
        const renderShop = (filter = {}, sort = 'relevance') => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            let filteredProducts = [...products];

            // Aplicar primero el filtro de consulta de búsqueda
            if (searchInput && searchInput.value) { // Añadir comprobación
                const query = searchInput.value.toLowerCase();
                filteredProducts = filteredProducts.filter(p =>
                    p.name.toLowerCase().includes(query) ||
                    p[`description_es`].toLowerCase().includes(query) ||
                    p.brand.toLowerCase().includes(query) ||
                    p.category.toLowerCase().includes(query) ||
                    p.subcategory.toLowerCase().includes(query)
                );
            }

            // Aplicar otros filtros
            if (filter.category) {
                filteredProducts = filteredProducts.filter(p => p.category === filter.category);
            }
            if (filter.subcategory) {
                filteredProducts = filteredProducts.filter(p => p.subcategory === filter.subcategory);
            }
            if (filter.brand) {
                filteredProducts = filteredProducts.filter(p => p.brand === filter.brand);
            }
            if (filter.certification) {
                filteredProducts = filteredProducts.filter(p => p.certifications.includes(filter.certification));
            }
            if (filter.benefit) {
                filteredProducts = filteredProducts.filter(p => p.benefits.includes(filter.benefit));
            }
            if (filter.minPrice !== undefined && !isNaN(filter.minPrice)) {
                filteredProducts = filteredProducts.filter(p => p.priceDetail >= filter.minPrice); // Usar filter.minPrice
            }
            if (filter.maxPrice !== undefined && !isNaN(filter.maxPrice)) {
                filteredProducts = filteredProducts.filter(p => p.priceDetail <= filter.maxPrice); // Usar filter.maxPrice
            }
            // NUEVO: Aplicar filtro isOffer (solo si se pasa explícitamente, no desde el filtro de UI para la tienda)
            if (filter.isOffer !== undefined) {
                filteredProducts = filteredProducts.filter(p => p.isOffer === filter.isOffer);
            }


            // Aplicar clasificación
            switch (sort) {
                case 'priceAsc':
                    filteredProducts.sort((a, b) => a.priceDetail - b.priceDetail); // Ordenar por priceDetail
                    break;
                case 'priceDesc':
                    filteredProducts.sort((a, b) => b.priceDetail - a.priceDetail); // Ordenar por priceDetail
                    break;
                case 'new':
                    // Ordenar por dateAdded en orden descendente (el más reciente primero)
                    filteredProducts.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
                    break;
                case 'bestsellers': // Esta opción de clasificación ya no está directamente en la navegación, pero es bueno mantenerla para mayor consistencia
                    // Ordenar por salesCount en orden descendente (el más vendido primero)
                    filteredProducts.sort((a, b) => b.salesCount - a.salesCount);
                    break;
                case 'customerRating': // Marcador de posición, necesita datos de calificación reales
                    // No hay clasificación específica para la calificación sin datos
                    break;
                default: // relevancia
                    // No hay clasificación específica para la relevancia sin datos más complejos
                    break;
            }

            // Obtener opciones de filtro únicas para los desplegables
            const categories = getUniqueCategories();
            const brands = getUniqueBrands();
            const certifications = getUniqueCertifications();
            const benefits = getUniqueBenefits();

            appContent.innerHTML = `
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Barra lateral de filtro -->
                    <aside class="lg:w-1/4 bg-white p-6 rounded-lg shadow-md mb-8 lg:mb-0">
                        <h3 class="text-xl font-bold text-primary mb-6">${lang.filterBy}</h3>
                        <div class="space-y-4">
                            <div>
                                <label for="filter-brand" class="block text-gray-700 font-semibold mb-2">${lang.brand}</label>
                                <select id="filter-brand" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="">${lang.all}</option>
                                    ${brands.map(b => `<option value="${b}" ${filter.brand === b ? 'selected' : ''}>${b}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label for="filter-category" class="block text-gray-700 font-semibold mb-2">${lang.productType}</label>
                                <select id="filter-category" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="">${lang.all}</option>
                                    ${categories.map(c => `<option value="${c}" ${filter.category === c ? 'selected' : ''}>${c}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label for="filter-benefit" class="block text-gray-700 font-semibold mb-2">${lang.healthBenefit}</label>
                                <select id="filter-benefit" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="">${lang.all}</option>
                                    ${benefits.map(b => `<option value="${b}" ${filter.benefit === b ? 'selected' : ''}>${b}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label for="filter-certification" class="block text-gray-700 font-semibold mb-2">${lang.certifications}</label>
                                <select id="filter-certification" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="">${lang.all}</option>
                                    ${certifications.map(c => `<option value="${c}" ${filter.certification === c ? 'selected' : ''}>${c}</option>`).join('')}
                                    </select>
                            </div>
                            <!-- Filtro de precio -->
                            <div>
                                <label for="filter-price-min" class="block text-gray-700 font-semibold mb-2">${lang.price} (Min)</label>
                                <input type="number" id="filter-price-min" placeholder="0" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary" value="${filter.minPrice !== undefined ? filter.minPrice : ''}">
                            </div>
                            <div>
                                <label for="filter-price-max" class="block text-gray-700 font-semibold mb-2">${lang.price} (Max)</label>
                                <input type="number" id="filter-price-max" placeholder="10000" class="w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary" value="${filter.maxPrice !== undefined ? filter.maxPrice : ''}">
                            </div>
                            <button onclick="applyFiltersAndSort()" class="w-full bg-primary text-white py-2 rounded-md hover:bg-green-700 transition duration-200">${lang.applyFilters}</button>
                        </div>
                    </aside>

                    <!-- Cuadrícula de productos -->
                    <section class="lg:w-3/4">
                        <div class="flex justify-between items-center mb-6 flex-wrap">
                            <h2 class="text-3xl font-bold text-primary">${lang.shop}</h2>
                            <div class="flex items-center space-x-2 mt-4 lg:mt-0">
                                <label for="sort-options" class="text-gray-700">${lang.sortBy}:</label>
                                <select id="sort-options" onchange="applyFiltersAndSort()" class="border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="relevance" ${sort === 'relevance' ? 'selected' : ''}>${lang.relevance}</option>
                                    <option value="priceAsc" ${sort === 'priceAsc' ? 'selected' : ''}>${lang.priceAsc}</option>
                                    <option value="priceDesc" ${sort === 'priceDesc' ? 'selected' : ''}>${lang.priceDesc}</option>
                                    <option value="new" ${sort === 'new' ? 'selected' : ''}>${lang.newest}</option>
                                    <option value="bestsellers" ${sort === 'bestsellers' ? 'selected' : ''}>${lang.mostSold}</option>
                                    <option value="customerRating" ${sort === 'customerRating' ? 'selected' : ''}>${lang.customerRating}</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${filteredProducts.length > 0 ?
                                filteredProducts.map(p => `
                                    <div class="bg-white rounded-lg shadow-md overflow-hidden hover-scale flex flex-col">
                                        <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)">
                                            <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/D3D3D3/000000?text=Imagen+No+Disp';" class="w-full h-48 object-contain p-4 rounded-t-lg">
                                        </a>
                                        <div class="p-4 flex-grow flex flex-col justify-between">
                                            <h3 class="text-lg font-semibold text-gray-800 mb-1">${p.name}</h3>
                                            <p class="text-gray-600 text-sm mb-2">${p.brand}</p>
                                            <p class="text-xl font-bold text-primary mb-3">${formatPrice(p.priceDetail)} ${p.priceWholesale ? `<span class="text-sm text-gray-500">(RD$${p.priceWholesale.toFixed(2)} Mayor)</span>` : ''}</p>
                                            <div class="flex items-center justify-center space-x-2 mt-2">
                                                <button onclick="updateProductQuantityInCart('${p.id}', -1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition duration-200">-</button>
                                                <input type="number" min="0" value="${(cart.find(item => item.productId === p.id)?.quantity || 0)}" 
                                                       data-product-id="${p.id}" 
                                                       onchange="updateProductQuantityInCartFromInput(this, '${p.id}')"
                                                       onkeypress="return event.charCode >= 48 && event.charCode <= 57"
                                                       class="w-16 text-center border border-gray-300 rounded-md p-1 focus:outline-none focus:ring-1 focus:ring-primary">
                                                <button onclick="updateProductQuantityInCart('${p.id}', 1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition duration-200">+</button>
                                            </div>
                                            <button onclick="addToCart('${p.id}')" class="bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200 mt-4">
                                                ${lang.addToCart}
                                            </button>
                                        </div>
                                    </div>
                                `).join('') :
                                `<p class="col-span-full text-center text-gray-600 text-lg">No se encontraron productos con los filtros seleccionados.</p>`
                            }
                        </div>
                    </section>
                </div>
            `;

            // Agregar oyentes de eventos para filtros después de renderizar
            document.getElementById('filter-brand')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('filter-category')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('filter-benefit')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('filter-certification')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('filter-price-min')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('filter-price-max')?.addEventListener('change', applyFiltersAndSort);
            document.getElementById('sort-options')?.addEventListener('change', applyFiltersAndSort);
        };


        /**
         * Renderiza la página de detalles del producto para un ID de producto dado.
         * @param {string} productId - El ID del producto a mostrar.
         */
        const renderProductDetail = (productId) => {
            const product = products.find(p => p.id === productId);
            const lang = translations[currentLanguage];

            if (!product) {
                if (appContent) { // Añadir comprobación
                    appContent.innerHTML = `<p class="text-center text-red-500 text-xl">Producto no encontrado.</p>`;
                }
                return;
            }
            if (!appContent) return; // Guardia para asegurar que appContent existe

            const descriptionContent = product[`description_es`];


            appContent.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-8 flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-1/2 flex justify-center items-center">
                        <img src="${product.image}" alt="${product.name}" onerror="this.onerror=null;this.src='https://placehold.co/600x600/D3D3D3/000000?text=Imagen+No+Disp';" class="max-w-full h-auto rounded-lg shadow-md object-contain">
                    </div>
                    <div class="lg:w-1/2">
                        <h1 class="text-4xl font-bold text-primary mb-2">${product.name}</h1>
                        <p class="text-xl text-gray-700 mb-4">${product.brand}</p>
                        <p class="text-5xl font-extrabold text-green-600 mb-6">${formatPrice(product.priceDetail)} ${product.priceWholesale ? `<span class="text-sm text-gray-500">(RD$${product.priceWholesale.toFixed(2)} Mayor)</span>` : ''}</p>
                        
                        <div class="flex items-center justify-start space-x-2 mb-4">
                            <button onclick="updateProductQuantityInCart('${product.id}', -1)" class="bg-gray-200 text-gray-700 w-10 h-10 rounded-full hover:bg-gray-300 transition duration-200 text-lg">-</button>
                            <input type="number" min="0" value="${(cart.find(item => item.productId === product.id)?.quantity || 0)}" 
                                   data-product-id="${product.id}" 
                                   onchange="updateProductQuantityInCartFromInput(this, '${product.id}')"
                                   onkeypress="return event.charCode >= 48 && event.charCode <= 57"
                                   class="w-20 text-center border border-gray-300 rounded-md p-2 text-lg focus:outline-none focus:ring-2 focus:ring-primary">
                            <button onclick="updateProductQuantityInCart('${product.id}', 1)" class="bg-gray-200 text-gray-700 w-10 h-10 rounded-full hover:bg-gray-300 transition duration-200 text-lg">+</button>
                        </div>
                        <button onclick="addToCart('${product.id}')" class="w-full bg-primary text-white text-xl py-3 rounded-full hover:bg-green-700 transition duration-200 mb-8">
                            <i class="fas fa-cart-plus mr-2"></i> ${lang.addToCart}
                        </button>

                        <!-- Pestaña única para la descripción (ahora incluye toda la información detallada) -->
                        <div class="border-b border-gray-200">
                            <nav class="-mb-px flex space-x-8 overflow-x-auto pb-2" aria-label="Tabs">
                                <button class="tab-button text-primary whitespace-nowrap py-4 px-1 border-b-2 border-primary font-medium text-lg" data-tab="description">${lang.description}</button>
                                <button class="tab-button text-gray-500 hover:text-gray-700 whitespace-nowrap py-4 px-1 border-b-2 border-transparent hover:border-gray-300 font-medium text-lg" data-tab="reviews">${lang.reviews}</button>
                            </nav>
                        </div>

                        <div id="tab-content" class="mt-6 text-gray-800 leading-relaxed">
                            <div id="tab-description" class="tab-pane active">${descriptionContent}</div>
                            <div id="tab-reviews" class="tab-pane hidden">
                                <p class="mb-2">Aún no hay opiniones para este producto. ¡Sé el primero en dejar una!</p>
                                <div class="flex items-center text-yellow-500 mb-4">
                                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i> (4/5)
                                </div>
                                <p class="text-sm text-gray-600">"Excelente producto, he notado una gran mejora en mi energía." - Cliente Satisfecho</p>
                            </div>
                        </div>

                        <!-- Certificaciones -->
                        <div class="mt-8">
                            <h3 class="text-xl font-semibold text-primary mb-3">Certificaciones:</h3>
                            <div class="flex flex-wrap gap-3">
                                ${product.certifications.map(cert => `
                                    <span class="bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full">${cert}</span>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Productos relacionados -->
                        <div class="mt-8">
                            <h3 class="text-xl font-semibold text-primary mb-4">${lang.relatedProducts}</h3>
                            <div class="grid grid-cols-2 gap-4">
                                ${products.filter(p => p.category === product.category && p.id !== product.id).slice(0, 2).map(p => `
                                    <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)" class="block bg-gray-50 rounded-lg p-3 text-center hover:bg-gray-100 transition duration-200">
                                        <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/100x100/D3D3D3/000000?text=Imagen+No+Disp';" class="w-24 h-24 object-contain mx-auto mb-2">
                                        <p class="text-sm font-medium text-gray-700">${p.name}</p>
                                        <p class="text-md font-bold text-primary">${formatPrice(p.priceDetail)}</p>
                                    </a>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Agregar lógica de cambio de pestaña después de renderizar el contenido
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.tab-button').forEach(btn => {
                        btn.classList.remove('text-primary', 'border-primary');
                        btn.classList.add('text-gray-500', 'hover:text-gray-700', 'border-transparent', 'hover:border-gray-300');
                    });
                    this.classList.add('text-primary', 'border-primary');
                    this.classList.remove('text-gray-500', 'hover:text-gray-700', 'border-transparent', 'hover:border-gray-300');

                    document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.add('hidden'));
                    document.getElementById(`tab-${this.dataset.tab}`).classList.remove('hidden');
                });
            });
        };

        /**
         * Renderiza la página de ofertas, mostrando un número limitado de productos y combos especiales.
         */
        const renderOffers = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            const offerProducts = products.filter(p => p.isOffer).slice(0, 3); // Obtener hasta 3 productos en oferta

            appContent.innerHTML = `
                <h1 class="text-4xl font-bold text-primary mb-8 text-center">${lang.offers}</h1>

                <section class="offer-products mb-12">
                    <h2 class="text-3xl font-bold text-center mb-8 text-primary">${lang.homePageNewProducts} en Oferta</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${offerProducts.map(p => `
                            <div class="bg-white rounded-lg shadow-md p-6 text-center hover-scale flex flex-col justify-between">
                                <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)">
                                    <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/D3D3D3/000000?text=Imagen+No+Disp';" class="w-full h-48 object-contain mb-4 mx-auto rounded-md">
                                </a>
                                <h3 class="text-lg font-semibold text-gray-800 mb-2">${p.name}</h3>
                                <p class="text-gray-600 text-sm mb-4">${p.brand}</p>
                                <p class="text-xl font-bold text-primary mb-4">${formatPrice(p.priceDetail)} <span class="text-sm text-gray-500 line-through">${formatPrice(p.priceDetail * 1.2)}</span></p>
                                <button onclick="addToCart('${p.id}')" class="bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">
                                    ${lang.addToCart}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </section>

                <section class="combo-offers mb-12">
                    <h2 class="text-3xl font-bold text-center mb-8 text-primary">${lang.comboSpecial}es</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        ${combos.map(combo => `
                            <div class="bg-white rounded-lg shadow-md p-6 hover-scale flex flex-col">
                                <a href="#combo-${combo.id}" onclick="navigateTo('combo', '${combo.id}', event)">
                                    <img src="${combo.image}" alt="${combo[`name_es`]}" onerror="this.onerror=null;this.src='https://placehold.co/400x200/D3D3D3/000000?text=Combo';" class="w-full h-48 object-cover mb-4 rounded-md">
                                </a>
                                <h3 class="text-2xl font-bold text-gray-800 mb-2">${combo[`name_es`]}</h3>
                                <p class="text-gray-600 text-sm mb-4">${combo[`description_es`]}</p>
                                <p class="text-2xl font-bold text-green-600 mb-4">${combo[`price_es`]}</p>
                                <button onclick="navigateTo('combo', '${combo.id}', event)" class="bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">
                                    ${lang.viewDetails}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `;
        };


        /**
         * Renderiza la página del carrito, mostrando los artículos, cantidades y totales.
         */
        const renderCartPage = () => { // Renombrado para evitar conflictos si `renderCart` se usa internamente
            console.log("Iniciando la función renderCartPage.");
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            let cartContent = '';

            if (cart.length === 0) {
                cartContent = `<p class="text-center text-gray-600 text-xl py-10">${lang.cartEmpty}</p>`;
            } else {
                cartContent = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white rounded-lg shadow-md mb-8">
                            <thead>
                                <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                    <th class="py-3 px-6 text-left">${lang.item}</th>
                                    <th class="py-3 px-6 text-center">${lang.price}</th>
                                    <th class="py-3 px-6 text-center">${lang.quantity}</th>
                                    <th class="py-3 px-6 text-center">${lang.subtotal}</th>
                                    <th class="py-3 px-6 text-center"></th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-600 text-sm font-light">
                                ${cart.map(item => {
                                    const product = products.find(p => p.id === item.productId);
                                    if (!product) return ''; // Fallback para producto faltante
                                    // Usar item.pricePerUnit que ya se calcula en función de la cantidad
                                    const itemSubtotal = item.pricePerUnit * item.quantity; 
                                    return `
                                        <tr class="border-b border-gray-200 hover:bg-gray-50">
                                            <td class="py-3 px-6 text-left whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <div class="mr-3">
                                                        <img class="w-10 h-10 rounded-full object-contain" src="${product.image}" alt="${product.name}" onerror="this.onerror=null;this.src='https://placehold.co/40x40/D3D3D3/000000?text=NP';">
                                                    </div>
                                                    <span class="font-medium">${product.name}</span>
                                                </div>
                                            </td>
                                            <td class="py-3 px-6 text-center">${formatPrice(item.pricePerUnit)}</td>
                                            <td class="py-3 px-6 text-center">
                                                <div class="flex items-center justify-center space-x-2">
                                                    <button onclick="updateQuantity('${item.productId}', -1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition duration-200">-</button>
                                                    <span class="text-base font-semibold">${item.quantity}</span>
                                                    <button onclick="updateQuantity('${item.productId}', 1)" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition duration-200">+</button>
                                                </div>
                                            </td>
                                            <td class="py-3 px-6 text-center font-semibold">${formatPrice(itemSubtotal)}</td>
                                            <td class="py-3 px-6 text-center">
                                                <button onclick="removeFromCart('${item.productId}')" class="text-red-500 hover:text-red-700 transition duration-200">
                                                    <i class="fas fa-trash"></i> ${lang.removeItem}
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div class="flex flex-col items-end space-y-4 w-full">
                        <!-- Resumen de totales -->
                        <div class="bg-gray-100 p-4 rounded-lg w-full md:w-1/2 lg:w-1/3 shadow-inner">
                            <div class="flex justify-between text-lg font-semibold text-gray-700 mb-2">
                                <span id="display-subtotal-label">${lang.subtotal}</span>
                                <span id="display-subtotal">${formatPrice(0)}</span>
                            </div>
                            <div class="flex justify-between text-lg font-semibold text-gray-700 mb-2">
                                <span id="display-discount-label">${lang.discount}</span>
                                <span id="display-discount">-${formatPrice(0)}</span>
                            </div>
                            <div class="flex justify-between text-lg font-semibold text-gray-700 mb-4 border-b pb-2">
                                <span id="display-shippingCost-label">${lang.shippingCost}</span>
                                <span id="display-shippingCost"></span>
                            </div>
                            <div class="flex justify-between text-2xl font-bold text-primary">
                                <span id="display-total-label">${lang.total}</span>
                                <span id="display-total"></span>
                            </div>
                        </div>
                        
                        <!-- Formulario de detalles del cliente -->
                        <div class="w-full lg:w-1/2 p-4 bg-gray-50 rounded-lg shadow-inner mt-6">
                            <h3 class="text-xl font-semibold text-primary mb-4">${lang.contactDetails}</h3>
                            <div class="space-y-3">
                                <div>
                                    <label for="customer-name" class="block text-gray-700 text-sm font-medium mb-1">${lang.fullName} <span class="text-red-500">*</span></label>
                                    <input type="text" id="customer-name" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.yourNamePlaceholder}" required>
                                </div>
                                <div>
                                    <label for="customer-address" class="block text-gray-700 text-sm font-medium mb-1">${lang.deliveryAddress} <span class="text-red-500">*</span></label>
                                    <input type="text" id="customer-address" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.yourAddressPlaceholder}" required>
                                </div>
                                <div>
                                    <label for="customer-phone-order" class="block text-gray-700 text-sm font-medium mb-1">${lang.yourPhoneNumber} <span class="text-red-500">*</span></label>
                                    <input type="tel" id="customer-phone-order" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.yourPhonePlaceholder}" required>
                                </div>
                            </div>

                            <!-- Método de entrega -->
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold text-gray-800 mb-3">${lang.deliveryMethod} <span class="text-red-500">*</span></h4>
                                <div class="flex flex-col space-y-2">
                                    <label class="inline-flex items-center">
                                        <input type="radio" class="form-radio text-primary h-5 w-5" name="delivery-method" value="A Domicilio" id="delivery-home">
                                        <span class="ml-2 text-gray-700">${lang.homeDelivery}</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="radio" class="form-radio text-primary h-5 w-5" name="delivery-method" value="Recoger en Tienda" id="delivery-store">
                                        <span class="ml-2 text-gray-700">${lang.storePickup}</span>
                                    </label>
                                </div>
                                <!-- Notas de costo de envío -->
                                <div id="delivery-cost-notes" class="mt-3 text-sm text-gray-600 p-3 bg-gray-100 rounded-md">
                                    <p>${lang.deliveryCostNoteSantoDomingo}</p>
                                    <p>${lang.deliveryCostNoteOutside}</p>
                                </div>
                            </div>

                            <!-- Método de pago -->
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold text-gray-800 mb-3">${lang.paymentMethod} <span class="text-red-500">*</span></h4>
                                <div class="flex flex-col space-y-2">
                                    <label class="inline-flex items-center">
                                        <input type="radio" class="form-radio text-primary h-5 w-5" name="payment-method" value="Efectivo" id="payment-cash">
                                        <span class="ml-2 text-gray-700">${lang.cash}</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="radio" class="form-radio text-primary h-5 w-5" name="payment-method" value="Transferencia Bancaria" id="payment-transfer">
                                        <span class="ml-2 text-gray-700">${lang.bankTransfer}</span>
                                    </label>
                                </div>
                                <!-- Detalles de la cuenta bancaria (inicialmente ocultos, se muestran al seleccionar Transferencia Bancaria) -->
                                <div id="bank-accounts-details" class="mt-3 text-sm text-gray-600 p-3 bg-gray-100 rounded-md hidden">
                                    <p class="font-semibold mb-2">${lang.bankAccounts}:</p>
                                    <ul class="list-disc list-inside space-y-1">
                                        <li>${lang.bankPopular}</li>
                                        <li>${lang.banreservas}</li>
                                        <li>${lang.bhd}</li>
                                    </ul>
                                </div>
                                <!-- Nota de confirmación de pago -->
                                <p id="payment-confirmation-note" class="mt-4 text-sm text-red-600 font-medium">
                                    ${lang.paymentConfirmationNote}
                                </p>
                            </div>
                            <!-- Nueva nota de descuento -->
                            <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800">
                                <p class="text-sm">
                                    ${lang.discountNote}
                                </p>
                            </div>
                        </div>

                        <div class="flex space-x-4 mt-6">
                            <button onclick="navigateTo('shop', null, event)" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 transition duration-200">
                                ${lang.continueShopping}
                            </button>
                            <!-- Actualizado: El botón de pago ahora llama a la función checkoutOrder -->
                            <button onclick="checkoutOrder()" class="bg-primary text-white px-8 py-3 rounded-full hover:bg-green-700 transition duration-200">
                                ${lang.checkout}
                            </button>
                        </div>
                    </div>
                `;
            }

            appContent.innerHTML = `
                <h1 class="text-4xl font-bold text-primary mb-8 text-center">${lang.yourCart}</h1>
                ${cartContent}
            `;
            
            // Volver a aplicar traducciones para los campos del formulario recién agregados
            updateContentLanguage(); 
            // Asegurar que el estado inicial de visibilidad de los detalles bancarios sea correcto cuando se renderiza el carrito
            toggleBankDetails(); 

            // Inicializar los oyentes de eventos para los elementos del formulario del carrito después de renderizar
            initCartFormListeners(); 
            // Asegurar que los totales se calculen y muestren inmediatamente después del renderizado
            calculateCartTotals();
            console.log("Terminada la función renderCartPage.");
        };


        /**
         * Renderiza el contenido de la página "Sobre Nosotros".
         */
        const renderAboutUs = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.aboutUsPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-4">
                        ${lang.aboutUsPageContent}
                    </p>
                    <div class="text-center mt-8">
                        <img src="./images/logo.jpg" alt="[Image of team R&F Integral Products]" class="mx-auto rounded-lg shadow-md max-w-full h-auto">
                    </div>
                </section>
            `;
        };

        /**
         * Renderiza la página "Enfermedades y Soluciones".
         * Esta página ahora lista todas las enfermedades como tarjetas clicables.
         */
        const renderEnfermedadesSoluciones = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.diseasesSolutions}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6">
                        Aquí encontrarás información valiosa sobre enfermedades comunes y cómo nuestros productos naturales pueden ofrecerte soluciones y apoyo para tu bienestar.
                        Recuerda que esta información es complementaria y no sustituye el consejo médico profesional.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${diseases.map(d => `
                            <a href="#disease-${d.id}" onclick="navigateTo('disease', '${d.id}', event)" class="block bg-gray-50 p-6 rounded-lg shadow-md flex flex-col items-center text-center hover-scale">
                                <img src="${d.image}" alt="${d[`name_es`]}" onerror="this.onerror=null;this.src='https://placehold.co/150x100/D3D3D3/000000?text=Enfermedad';" class="w-36 h-24 object-cover rounded-md mb-4">
                                <h3 class="text-xl font-semibold text-gray-800 mb-2">${d[`name_es`]}</h3>
                                <p class="text-gray-600 text-sm">${lang.viewDetails}</p>
                            </a>
                        `).join('')}
                    </div>
                </section>
            `;
        };

        /**
         * Renderiza una página detallada para una enfermedad específica.
         * @param {string} diseaseId - El ID de la enfermedad a mostrar.
         */
        const renderDiseaseDetail = (diseaseId) => {
            const disease = diseases.find(d => d.id === diseaseId);
            const lang = translations[currentLanguage];

            if (!disease) {
                if (appContent) { // Añadir comprobación
                    appContent.innerHTML = `<p class="text-center text-red-500 text-xl">Enfermedad no encontrada.</p>`;
                }
                return;
            }
            if (!appContent) return; // Guardia para asegurar que appContent existe

            const diseaseDescription = disease[`description_es`];

            // Filtrar productos basados en relatedBenefits o relatedProducts (priorizar direct relatedProducts)
            const relatedProducts = disease.relatedProducts.map(pId => products.find(p => p.id === pId)).filter(Boolean);


            appContent.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${disease[`name_es`]}</h1>
                    
                    <div class="flex flex-col md:flex-row gap-8 mb-8">
                        <div class="md:w-1/3 flex justify-center items-start">
                            <img src="${disease.image}" alt="${disease[`name_es`]}" onerror="this.onerror=null;this.src='https://placehold.co/300x200/D3D3D3/000000?text=Enfermedad';" class="max-w-full h-auto rounded-lg shadow-md object-contain">
                        </div>
                        <div class="md:w-2/3">
                            <h3 class="text-2xl font-bold text-primary mb-3">${lang.diseaseDescription}</h3>
                            <div class="text-gray-800 leading-relaxed mb-6">
                                ${diseaseDescription}
                            </div>
                        </div>
                    </div>

                    ${relatedProducts.length > 0 ? `
                    <div class="mt-8">
                        <h2 class="text-3xl font-bold text-primary mb-6 text-center">${lang.productsForThis}</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${relatedProducts.map(p => `
                                <div class="bg-gray-50 rounded-lg shadow-md p-6 text-center hover-scale flex flex-col justify-between">
                                    <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)">
                                        <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/D3D3D3/000000?text=Imagen+No+Disp';" class="w-full h-48 object-contain mb-4 mx-auto rounded-md">
                                    </a>
                                    <h3 class="text-lg font-semibold text-gray-800 mb-2">${p.name}</h3>
                                    <p class="text-gray-600 text-sm mb-4">${p.brand}</p>
                                    <p class="text-xl font-bold text-primary mb-4">${formatPrice(p.priceDetail)}</p>
                                    <button onclick="addToCart('${p.id}')" class="bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">
                                        ${lang.addToCart}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : `<p class="text-center text-gray-600 text-lg mt-8">No hay productos directamente relacionados en este momento.</p>`}
                </div>
            `;
        };

        /**
         * Renderiza la página "Contacto".
         */
        const renderContact = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            const whatsappNumber = '18094254540'; // El mismo número de WhatsApp para pedidos
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.contactPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6">
                        ${lang.contactPageIntro}
                    </p>
                    <div class="space-y-4 text-gray-800 text-lg">
                        <p><strong>${lang.phoneLabel}</strong> <a href="https://wa.me/${whatsappNumber}" target="_blank" class="text-primary hover:underline">WhatsApp (+${whatsappNumber})</a></p>
                        <p><strong>${lang.emailLabel}</strong> <a href="mailto:productosintegralesryf@gmail.com" class="text-primary hover:underline">productosintegralesryf@gmail.com</a></p>
                        <p><strong>${lang.websiteLabel}</strong> <a href="https://ryfproductosintegrales.com" target="_blank" class="text-primary hover:underline">ryfproductosintegrales.com</a></p>
                        <p><strong>${lang.addressLabel}</strong> Santo Domingo, República Dominicana</p>
                        <p><strong>${lang.hoursLabel}</strong> ${lang.hours}</p>
                    </div>
                    <div class="mt-8">
                        <h2 class="text-2xl font-bold text-primary mb-4">Envíanos un Mensaje</h2>
                        <form class="space-y-4">
                            <div>
                                <label for="contact-name" class="block text-gray-700 text-sm font-medium mb-1">${lang.fullName}</label>
                                <input type="text" id="contact-name" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.namePlaceholder}">
                            </div>
                            <div>
                                <label for="contact-email" class="block text-gray-700 text-sm font-medium mb-1">${lang.emailLabel}</label>
                                <input type="email" id="contact-email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.emailPlaceholder}">
                            </div>
                            <div>
                                <label for="contact-message" class="block text-gray-700 text-sm font-medium mb-1">Tu Mensaje</label>
                                <textarea id="contact-message" rows="5" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Escribe tu mensaje aquí..."></textarea>
                            </div>
                            <button type="submit" class="bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">Enviar Mensaje</button>
                        </form>
                    </div>
                </section>
            `;
        };

        /**
         * Renderiza la página "Blog".
         */
        const renderBlog = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.ourBlogTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8">
                        ${lang.blogIntro}
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${blogPosts.map(post => `
                            <div class="bg-gray-50 rounded-lg shadow-md overflow-hidden">
                                <img src="${post.image}" alt="[Image of ${post.title_es}]" class="w-full h-48 object-cover">
                                <div class="p-6">
                                    <h3 class="text-xl font-semibold text-gray-800 mb-2">${post.title_es}</h3>
                                    <p class="text-gray-600 text-sm mb-4">${post.excerpt_es}</p>
                                    <a href="#blog-post-${post.id}" onclick="navigateTo('blog-post', '${post.id}', event)" class="text-primary hover:underline font-medium">Leer Más</a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </section>
            `;
        };

        /**
         * NUEVO: Renderiza la página de detalles de una publicación de blog específica.
         * @param {string} blogPostId - El ID de la publicación del blog a mostrar.
         */
        const renderBlogPost = (blogPostId) => {
            const post = blogPosts.find(p => p.id === blogPostId);
            const lang = translations[currentLanguage];

            if (!post) {
                if (appContent) { // Añadir comprobación
                    appContent.innerHTML = `<p class="text-center text-red-500 text-xl">Publicación de blog no encontrada.</p>`;
                }
                return;
            }
            if (!appContent) return; // Guardia para asegurar que appContent existe

            appContent.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${post.title_es}</h1>
                    <div class="text-center mb-6">
                        <p class="text-gray-600 text-sm">Por ${post.author} el ${new Date(post.date).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                        <div class="flex flex-wrap justify-center gap-2 mt-2">
                            ${post.tags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded-full">${tag}</span>`).join('')}
                        </div>
                    </div>
                    <img src="${post.image}" alt="[Image of ${post.title_es}]" class="w-full h-64 object-cover rounded-lg shadow-md mb-8">
                    <div class="text-gray-800 leading-relaxed mb-8">
                        ${post.content_es}
                    </div>
                    <div class="text-center mt-8">
                        <button onclick="navigateTo('blog', null, event)" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 transition duration-200">Volver al Blog</button>
                    </div>
                </div>
            `;
        };

        /**
         * Renderiza la página "Métodos de Pago".
         */
        const renderPaymentMethods = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.paymentMethodsPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8">
                        ${lang.paymentMethodsIntro}
                    </p>
                    <div class="space-y-6">
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-2xl font-semibold text-gray-800 mb-3">${lang.cash}</h3>
                            <p class="text-gray-700">Puedes pagar en efectivo al momento de recibir tu pedido si eliges la opción de entrega a domicilio o al recoger en tienda.</p>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-2xl font-semibold text-gray-800 mb-3">${lang.bankTransfer}</h3>
                            <p class="text-gray-700 mb-4">Puedes realizar una transferencia bancaria a una de nuestras cuentas. Por favor, asegúrate de hacer el pago una vez que tu pedido haya sido confirmado por nuestro equipo.</p>
                            <h4 class="font-semibold text-lg text-primary mb-2">${lang.bankAccounts}</h4>
                            <ul class="list-disc list-inside ml-4 text-gray-700">
                                <li>${lang.bankPopular}</li>
                                <li>${lang.banreservas}</li>
                                <li>${lang.bhd}</li>
                            </ul>
                        </div>
                    </div>
                </section>
            `;
        };

        /**
         * Renderiza la página "Iniciar Sesión".
         */
        const renderLogin = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.loginPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6 text-center">
                        ${lang.loginIntro}
                    </p>
                    <form class="space-y-4">
                        <div>
                            <label for="login-email" class="block text-gray-700 text-sm font-medium mb-1">${lang.emailLabel}</label>
                            <input type="email" id="login-email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.emailPlaceholder}">
                        </div>
                        <div>
                            <label for="login-password" class="block text-gray-700 text-sm font-medium mb-1">${lang.passwordPlaceholder}</label>
                            <input type="password" id="login-password" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.passwordPlaceholder}">
                        </div>
                        <button type="submit" class="w-full bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">${lang.loginButton}</button>
                    </form>
                    <p class="text-center mt-4">
                        <a href="#" class="text-primary hover:underline">${lang.forgotPassword}</a>
                    </p>
                    <p class="text-center mt-2 text-gray-600">
                        ${lang.dontHaveAccount} <a href="#register" onclick="navigateTo('register', null, event)" class="text-primary hover:underline">${lang.register}</a>
                    </p>
                </section>
            `;
        };

        /**
         * Renderiza la página "Registrarse".
         */
        const renderRegister = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.registerPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6 text-center">
                        ${lang.registerIntro}
                    </p>
                    <form class="space-y-4">
                        <div>
                            <label for="register-name" class="block text-gray-700 text-sm font-medium mb-1">${lang.fullName}</label>
                            <input type="text" id="register-name" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.namePlaceholder}">
                        </div>
                        <div>
                            <label for="register-email" class="block text-gray-700 text-sm font-medium mb-1">${lang.emailLabel}</label>
                            <input type="email" id="register-email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.emailPlaceholder}">
                        </div>
                        <div>
                            <label for="register-password" class="block text-gray-700 text-sm font-medium mb-1">${lang.passwordPlaceholder}</label>
                            <input type="password" id="register-password" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.passwordPlaceholder}">
                        </div>
                        <div>
                            <label for="register-confirm-password" class="block text-gray-700 text-sm font-medium mb-1">${lang.confirmPasswordPlaceholder}</label>
                            <input type="password" id="register-confirm-password" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="${lang.confirmPasswordPlaceholder}">
                        </div>
                        <button type="submit" class="w-full bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">${lang.registerButton}</button>
                    </form>
                    <p class="text-center mt-2 text-gray-600">
                        ${lang.alreadyHaveAccount} <a href="#login" onclick="navigateTo('login', null, event)" class="text-primary hover:underline">${lang.login}</a>
                    </p>
                </section>
            `;
        };

        /**
         * Renderiza la página "Mi Cuenta".
         */
        const renderMyAccount = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${lang.myAccountPageTitle}</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8 text-center">
                        ${lang.myAccountIntro}
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-semibold text-gray-800 mb-3">Mis Pedidos</h3>
                            <p class="text-gray-600">Aquí podrás ver el historial de tus pedidos y su estado.</p>
                            <button onclick="navigateTo('my-orders', null, event)" class="mt-4 bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">Ver Pedidos</button>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-semibold text-gray-800 mb-3">Mi Información</h3>
                            <p class="text-gray-600">Actualiza tu nombre, correo electrónico y contraseña.</p>
                            <button onclick="navigateTo('my-info', null, event)" class="mt-4 bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">Editar Perfil</button>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-semibold text-gray-800 mb-3">Mis Direcciones</h3>
                            <p class="text-gray-600">Gestiona tus direcciones de envío y facturación.</p>
                            <button class="mt-4 bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">Gestionar Direcciones</button>
                        </div>
                    </div>
                </section>
            `;
        };

        /**
         * Renderiza la página "Mis Pedidos".
         */
        const renderMyOrders = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">Mis Pedidos</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8">
                        Aquí verás el historial de tus pedidos. (Funcionalidad a desarrollar: integración con un sistema de pedidos).
                    </p>
                    <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">Historial de Pedidos (Ejemplo)</h3>
                        <ul class="space-y-4">
                            <li class="border-b pb-2">
                                <p class="font-semibold">Pedido #20250628-001</p>
                                <p class="text-sm text-gray-600">Fecha: 28/06/2025 | Total: RD$1,500.00 | Estado: Pendiente</p>
                                <p class="text-sm text-gray-600">Productos: Vitamina C (x2), Magnesio Glicinato (x1)</p>
                            </li>
                            <li class="border-b pb-2">
                                <p class="font-semibold">Pedido #20250620-005</p>
                                <p class="text-sm text-gray-600">Fecha: 20/06/2025 | Total: RD$850.00 | Estado: Entregado</p>
                                <p class="text-sm text-gray-600">Productos: Té de Manzanilla (x1), Aceite de Coco (x1)</p>
                            </li>
                        </ul>
                    </div>
                    <button onclick="navigateTo('my-account', null, event)" class="mt-8 bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 transition duration-200">Volver a Mi Cuenta</button>
                </section>
            `;
        };

        /**
         * Renderiza la página "Mi Información".
         */
        const renderMyInfo = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">Mi Información</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8 text-center">
                        Actualiza tus datos personales. (Funcionalidad a desarrollar: guardar cambios en el backend).
                    </p>
                    <form class="space-y-4">
                        <div>
                            <label for="profile-name" class="block text-gray-700 text-sm font-medium mb-1">Nombre Completo</label>
                            <input type="text" id="profile-name" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" value="Tu Nombre Actual">
                        </div>
                        <div>
                            <label for="profile-email" class="block text-gray-700 text-sm font-medium mb-1">Correo Electrónico</label>
                            <input type="email" id="profile-email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" value="tu.correo@ejemplo.com">
                        </div>
                        <div>
                            <label for="profile-password" class="block text-gray-700 text-sm font-medium mb-1">Nueva Contraseña</label>
                            <input type="password" id="profile-password" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Dejar en blanco para no cambiar">
                        </div>
                        <div>
                            <label for="profile-confirm-password" class="block text-gray-700 text-sm font-medium mb-1">Confirmar Nueva Contraseña</label>
                            <input type="password" id="profile-confirm-password" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Repetir nueva contraseña">
                        </div>
                        <button type="submit" class="w-full bg-primary text-white px-6 py-3 rounded-full hover:bg-green-700 transition duration-200">Guardar Cambios</button>
                    </form>
                    <button onclick="navigateTo('my-account', null, event)" class="mt-8 bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 transition duration-200">Volver a Mi Cuenta</button>
                </section>
            `;
        };

        /**
         * Renderiza la página "Mis Direcciones".
         */
        const renderMyAddresses = () => {
            const lang = translations[currentLanguage];
            if (!appContent) return; // Guardia para asegurar que appContent existe
            appContent.innerHTML = `
                <section class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">Mis Direcciones</h1>
                    <p class="text-lg text-gray-700 leading-relaxed mb-8">
                        Gestiona tus direcciones de envío y facturación. (Funcionalidad a desarrollar: añadir/editar/eliminar direcciones).
                    </p>
                    <div class="space-y-6">
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-semibold text-gray-800 mb-3">Dirección Principal</h3>
                            <p class="text-gray-700">Calle Ejemplo #123, Sector Naco, Santo Domingo, R.D.</p>
                            <button class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition duration-200">Editar</button>
                            <button class="mt-4 ml-2 bg-red-500 text-white px-4 py-2 rounded-full hover:bg-red-700 transition duration-200">Eliminar</button>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-semibold text-gray-800 mb-3">Añadir Nueva Dirección</h3>
                            <p class="text-gray-600">Haz clic para agregar una nueva dirección de envío.</p>
                            <button class="mt-4 bg-primary text-white px-4 py-2 rounded-full hover:bg-green-700 transition duration-200">Añadir Dirección</button>
                        </div>
                    </div>
                    <button onclick="navigateTo('my-account', null, event)" class="mt-8 bg-gray-200 text-gray-700 px-6 py-3 rounded-full hover:bg-gray-300 transition duration-200">Volver a Mi Cuenta</button>
                </section>
            `;
        };

        /**
         * Renderiza una página detallada para un combo específico.
         * @param {string} comboId - El ID del combo a mostrar.
         */
        const renderComboDetail = (comboId) => {
            const combo = combos.find(c => c.id === comboId);
            const lang = translations[currentLanguage];

            if (!combo) {
                if (appContent) { // Añadir comprobación
                    appContent.innerHTML = `<p class="text-center text-red-500 text-xl">Combo no encontrado.</p>`;
                }
                return;
            }
            if (!appContent) return; // Guardia para asegurar que appContent existe

            const comboDescription = combo[`description_es`];

            // Obtener los objetos de producto reales para el combo
            const comboProductsDetails = combo.products.map(pId => products.find(p => p.id === pId)).filter(Boolean);

            appContent.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-8 mb-12">
                    <h1 class="text-4xl font-bold text-primary mb-6 text-center">${combo[`name_es`]}</h1>
                    
                    <div class="flex flex-col md:flex-row gap-8 mb-8">
                        <div class="md:w-1/3 flex justify-center items-start">
                            <img src="${combo.image}" alt="${combo[`name_es`]}" onerror="this.onerror=null;this.src='https://placehold.co/400x200/D3D3D3/000000?text=Combo';" class="max-w-full h-auto rounded-lg shadow-md object-contain">
                        </div>
                        <div class="md:w-2/3">
                            <h3 class="text-2xl font-bold text-primary mb-3">Descripción del Combo:</h3>
                            <div class="text-gray-800 leading-relaxed mb-6">
                                <p>${comboDescription}</p>
                            </div>
                            <p class="text-3xl font-extrabold text-green-600 mb-6">${combo[`price_es`]}</p>
                            <button onclick="showModal('${lang.productAdded}', 'Añadir combo ${combo.id} al carrito - funcionalidad a implementar')" class="w-full bg-primary text-white text-xl py-3 rounded-full hover:bg-green-700 transition duration-200 mb-4">
                                Añadir Combo al Carrito
                            </button>
                        </div>
                    </div>

                    <div class="mt-8">
                        <h2 class="text-3xl font-bold text-primary mb-6 text-center">${lang.comboContents}</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                            ${comboProductsDetails.map(p => `
                                <div class="bg-gray-50 rounded-lg shadow-md p-4 text-center hover-scale flex flex-col justify-between">
                                    <a href="#product-${p.id}" onclick="navigateTo('product', '${p.id}', event)">
                                        <img src="${p.image}" alt="${p.name}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/D3D3D3/000000?text=Imagen+No+Disp';" class="w-full h-32 object-contain mb-4 mx-auto rounded-md">
                                    </a>
                                    <h3 class="text-lg font-semibold text-gray-800 mb-1">${p.name}</h3>
                                    <p class="text-gray-600 text-sm mb-2">${p.brand}</p>
                                    <p class="text-xl font-bold text-primary mb-3">${formatPrice(p.priceDetail)}</p>
                                    <button onclick="navigateTo('product', '${p.id}', event)" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-full hover:bg-gray-300 transition duration-200 text-sm">
                                        ${lang.goToProduct}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        };


        // --- Funciones de gestión del carrito ---

        /**
         * Calcula el precio correcto para un producto en función de su cantidad (detalle vs. mayorista).
         * @param {Object} product - El objeto del producto.
         * @param {number} quantity - La cantidad del producto.
         * @returns {number} El precio por unidad calculado.
         */
        const getProductPrice = (product, quantity) => {
            // Se asume que el precio al por mayor se aplica si la cantidad es 6 o más
            const WHOLESALE_QUANTITY_THRESHOLD = 6;
            if (product.priceWholesale && quantity >= WHOLESALE_QUANTITY_THRESHOLD) {
                return product.priceWholesale;
            }
            return product.priceDetail;
        };

        /**
         * Agrega un producto al carrito o incrementa su cantidad si ya está presente.
         * Recalcula pricePerUnit en función de la cantidad actual.
         * @param {string} productId - El ID del producto a agregar.
         */
        const addToCart = (productId) => {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const existingItemIndex = cart.findIndex(item => item.productId === productId);
            let newQuantity;

            if (existingItemIndex > -1) {
                newQuantity = cart[existingItemIndex].quantity + 1;
                cart[existingItemIndex].quantity = newQuantity;
            } else {
                newQuantity = 1;
                cart.push({ productId, quantity: newQuantity });
            }

            // Actualizar pricePerUnit en función de la nueva cantidad para el artículo
            const itemInCart = cart.find(item => item.productId === productId);
            if (itemInCart) {
                itemInCart.pricePerUnit = getProductPrice(product, newQuantity);
            }

            saveCart();
            updateCartCount();
            showModal(translations[currentLanguage].productAdded, translations[currentLanguage].addedSuccessfully);
            // Volver a renderizar la página de la tienda para actualizar las entradas de cantidad si se encuentra en la página de la tienda
            if (currentPage === 'shop') {
                renderShop();
            } else if (currentPage === 'product') {
                // También actualizar el campo de entrada en la página de detalles del producto si el usuario está allí
                const productQuantityInput = document.querySelector(`input[data-product-id="${productId}"]`);
                 if (productQuantityInput) {
                    productQuantityInput.value = newQuantity;
                 }
            }
        };

        /**
         * Actualiza la cantidad de un producto en el carrito. Elimina el artículo si la cantidad baja a 0 o menos.
         * Recalcula pricePerUnit en función de la cantidad actualizada.
         * @param {string} productId - El ID del producto a actualizar.
         * @param {number} change - La cantidad para cambiar la cantidad (ej., 1 para incrementar, -1 para decrementar).
         */
        const updateQuantity = (productId, change) => {
            console.log(`Intentando actualizar la cantidad para el producto: ${productId} con cambio: ${change}`);
            const itemIndex = cart.findIndex(item => item.productId === productId);
            if (itemIndex > -1) {
                // Corregido: Usar productId directamente para encontrar el producto en el array de productos
                const product = products.find(p => p.id === item.productId); // Corregido: buscar product usando item.productId
                if (!product) {
                    console.error(`Producto con ID ${item.productId} no encontrado en el array de productos para la actualización de cantidad.`);
                    return;
                }

                let newQuantity = cart[itemIndex].quantity + change;
                if (newQuantity < 0) newQuantity = 0; // Evitar cantidad negativa

                if (newQuantity === 0) {
                    cart.splice(itemIndex, 1); // Eliminar si la cantidad es 0
                    console.log(`Producto ${productId} eliminado del carrito. Nuevo carrito:`, cart);
                } else {
                    cart[itemIndex].quantity = newQuantity;
                    // Recalcular el precio por unidad en función de la nueva cantidad
                    cart[itemIndex].pricePerUnit = getProductPrice(product, newQuantity);
                    console.log(`Cantidad del producto ${productId} actualizada a ${newQuantity}. Nuevo precio por unidad: ${cart[itemIndex].pricePerUnit}. Nuevo carrito:`, cart);
                }
                saveCart();
                updateCartCount();
                renderCartPage(); // Volver a renderizar el carrito para mostrar cantidades/totales actualizados
                console.log(`Carrito re-renderizado después de la actualización de cantidad.`);
            } else {
                console.warn(`Producto ${productId} no encontrado en el carrito para la actualización de cantidad. Carrito actual:`, cart);
            }
        };

        /**
         * Actualiza la cantidad del producto en el carrito directamente desde un campo de entrada (ej., en la página de la tienda).
         * @param {HTMLInputElement} inputElement - El elemento de entrada que activó el cambio.
         * @param {string} productId - El ID del producto.
         */
        const updateProductQuantityInCartFromInput = (inputElement, productId) => {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            let newQuantity = parseInt(inputElement.value) || 0; // Analizar el valor, por defecto 0 si es inválido
            if (newQuantity < 0) newQuantity = 0; // Asegurar que no sea negativo

            const itemIndex = cart.findIndex(item => item.productId === productId);

            if (newQuantity > 0) {
                if (itemIndex > -1) {
                    cart[itemIndex].quantity = newQuantity;
                    cart[itemIndex].pricePerUnit = getProductPrice(product, newQuantity);
                } else {
                    cart.push({
                        productId: productId,
                        quantity: newQuantity,
                        pricePerUnit: getProductPrice(product, newQuantity)
                    });
                }
            } else {
                if (itemIndex > -1) {
                    cart.splice(itemIndex, 1);
                }
            }
            saveCart();
            updateCartCount();
            if (currentPage === 'cart') { // Solo volver a renderizar el carrito si está en la propia página del carrito
                renderCartPage();
            }
        };

        /**
         * Esta función es específicamente para cambios de cantidad desde la tienda o la página de detalles del producto.
         * Actualiza el carrito local y el campo de entrada correspondiente.
         * @param {string} productId - El ID del producto.
         * @param {number} change - La cantidad para cambiar la cantidad (ej., 1 para incrementar, -1 para decrementar).
         */
        const updateProductQuantityInCart = (productId, change) => {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const inputElement = document.querySelector(`input[data-product-id="${productId}"]`);
            if (!inputElement) return; // Guardia: asegurar que el elemento de entrada exista

            let currentQuantity = parseInt(inputElement.value) || 0;
            let newQuantity = currentQuantity + change;

            if (newQuantity < 0) newQuantity = 0;

            // Actualizar el array del carrito directamente
            const itemIndex = cart.findIndex(item => item.productId === productId);
            if (newQuantity > 0) {
                if (itemIndex > -1) {
                    cart[itemIndex].quantity = newQuantity;
                } else {
                    cart.push({ productId, quantity: newQuantity, pricePerUnit: product.priceDetail }); // Precio inicial, se actualizará por getProductPrice
                }
                // Siempre recalcular pricePerUnit en función de la nueva cantidad
                const updatedItem = cart.find(item => item.productId === productId);
                if (updatedItem) {
                    updatedItem.pricePerUnit = getProductPrice(product, newQuantity);
                }
            } else {
                if (itemIndex > -1) {
                    cart.splice(itemIndex, 1);
                }
            }

            inputElement.value = newQuantity > 0 ? newQuantity : 0; // Actualizar la visualización del campo de entrada, explícitamente 0
            saveCart();
            updateCartCount();
        };


        /**
         * Elimina un producto completamente del carrito.
         * @param {string} productId - El ID del producto a eliminar.
         */
        const removeFromCart = (productId) => {
            cart = cart.filter(item => item.productId !== productId);
            saveCart();
            updateCartCount();
            renderCartPage(); // Volver a renderizar el carrito
        };

        /**
         * Calcula el subtotal, el descuento, el costo de envío y el total para el carrito actual.
         * También actualiza los elementos de visualización directamente.
         * @returns {Object} Un objeto que contiene subtotal, descuento, shippingCost y total.
         */
        const calculateCartTotals = () => {
            console.log("Calculando totales del carrito...");
            let subtotal = 0;
            cart.forEach(item => {
                const product = products.find(p => p.id === item.productId);
                if (product) {
                    // Asegurar que pricePerUnit se actualice en el artículo del carrito según la cantidad actual
                    item.pricePerUnit = getProductPrice(product, item.quantity);
                    subtotal += item.quantity * item.pricePerUnit;
                }
            });

            // Lógica de descuento (ej., 5% de descuento para pedidos superiores a RD$1000, 10% para superiores a RD$2000)
            let discount = 0;
            // Lógica de descuento de ejemplo (ajustar según sea necesario)
            if (subtotal >= 2000) {
                discount = subtotal * 0.10; // 0% de descuento para pedidos superiores a 0000
            } else if (subtotal >= 1000) {
                discount = subtotal * 0.05; // % de descuento para pedidos superiores a 0000
            }


            let shippingCost = 0;
            const deliveryMethodRadio = document.querySelector('input[name="delivery-method"]:checked');
            const deliveryMethod = deliveryMethodRadio ? deliveryMethodRadio.value : '';
            const customerAddressInput = document.getElementById('customer-address');
            const customerAddress = customerAddressInput ? customerAddressInput.value.toLowerCase().trim() : '';

            if (deliveryMethod === "A Domicilio") {
                // Comprobar si la dirección contiene "santo domingo" o "dn" o "distrito nacional"
                // Usando includes() para una coincidencia flexible de ciudad/provincia
                if (customerAddress.includes("santo domingo") || customerAddress.includes("dn") || customerAddress.includes("distrito nacional")) {
                    shippingCost = 400; // Costo para el Gran Santo Domingo / DN
                } else if (customerAddress !== '') { // Si se ingresa una dirección no local (cualquier dirección fuera de Santo Domingo/DN)
                    shippingCost = 600; // Costo para fuera de esa área
                } else {
                    shippingCost = 0; // Por defecto a 0 si aún no se ha ingresado ninguna dirección para entrega a domicilio
                }
            } else if (deliveryMethod === "Recoger en Tienda") {
                shippingCost = 0;
            }

            const total = subtotal - discount + shippingCost;

            // --- NUEVO: Actualizar los elementos de visualización directamente ---
            // Estos IDs se agregan a los spans en renderCart para manipulación directa
            const subtotalDisplay = document.getElementById('display-subtotal');
            const discountDisplay = document.getElementById('display-discount');
            const shippingDisplay = document.getElementById('display-shippingCost');
            const totalDisplay = document.getElementById('display-total');
            const subtotalLabel = document.getElementById('display-subtotal-label');
            const discountLabel = document.getElementById('display-discount-label');
            const shippingLabel = document.getElementById('display-shippingCost-label');
            const totalLabel = document.getElementById('display-total-label');


            if (subtotalDisplay) subtotalDisplay.textContent = formatPrice(subtotal);
            if (discountDisplay) discountDisplay.textContent = `-${formatPrice(discount)}`;
            if (shippingDisplay) shippingDisplay.textContent = `+${formatPrice(shippingCost)}`;
            if (totalDisplay) totalDisplay.textContent = formatPrice(total);

            // Asegurar que las etiquetas se muestren correctamente desde las traducciones
            if (subtotalLabel) subtotalLabel.textContent = translations[currentLanguage].subtotal;
            if (discountLabel) discountLabel.textContent = translations[currentLanguage].discount;
            if (shippingLabel) shippingLabel.textContent = translations[currentLanguage].shippingCost;
            if (totalLabel) totalLabel.textContent = translations[currentLanguage].total;

            console.log("Totales del carrito calculados y actualizados:", { subtotal, discount, shippingCost, total });

            return { subtotal, discount, shippingCost, total };
        };


        /**
         * Función de ayuda para obtener el valor del botón de radio seleccionado por nombre.
         * @param {string} name - El atributo 'name' de los botones de radio.
         * @returns {string|null} El valor del botón de radio seleccionado, o null si no hay ninguno seleccionado.
         */
        const getSelectedRadioValue = (name) => {
            const radios = document.querySelectorAll(`input[name="${name}"]:checked`);
            return radios.length > 0 ? radios[0].value : null;
        };

        /**
         * Alterna la visibilidad de los detalles de la cuenta bancaria en función de la selección del método de pago.
         * Esta función es llamada por el evento onchange de los botones de radio del método de pago.
         */
        const toggleBankDetails = () => {
            const paymentTransferRadio = document.getElementById('payment-transfer');
            const bankDetailsDiv = document.getElementById('bank-accounts-details');
            if (paymentTransferRadio && bankDetailsDiv) {
                if (paymentTransferRadio.checked) {
                    bankDetailsDiv.classList.remove('hidden');
                } else {
                    bankDetailsDiv.classList.add('hidden');
                }
            }
        };

        /**
         * Adjunta oyentes de eventos para todos los elementos del formulario dentro de la sección del carrito.
         * Esto es crucial para volver a adjuntar los oyentes después de volver a renderizar el HTML del carrito.
         */
        const initCartFormListeners = () => {
            const customerAddressInput = document.getElementById('customer-address');
            if (customerAddressInput) {
                customerAddressInput.addEventListener('input', calculateCartTotals); // Escuchar cambios de entrada
            }

            const deliveryHomeRadio = document.getElementById('delivery-home');
            if (deliveryHomeRadio) {
                deliveryHomeRadio.addEventListener('change', calculateCartTotals); // Escuchar cambios de radio
            }

            const deliveryStoreRadio = document.getElementById('delivery-store');
            if (deliveryStoreRadio) {
                deliveryStoreRadio.addEventListener('change', calculateCartTotals); // Escuchar cambios de radio
            }

            const paymentCashRadio = document.getElementById('payment-cash');
            if (paymentCashRadio) {
                paymentCashRadio.addEventListener('change', toggleBankDetails); // Escuchar cambios de radio
            }

            const paymentTransferRadio = document.getElementById('payment-transfer');
            if (paymentTransferRadio) {
                paymentTransferRadio.addEventListener('change', toggleBankDetails); // Escuchar cambios de radio
            }
        };


        /**
         * Maneja el proceso de pago generando un mensaje de WhatsApp con los detalles del pedido y la información del cliente.
         */
        const checkoutOrder = () => {
            const lang = translations[currentLanguage];
            console.log("Intentando realizar el pago.");

            if (cart.length === 0) {
                showModal(lang.cartEmpty, lang.cartEmpty);
                console.warn("Pago abortado: El carrito está vacío.");
                return;
            }

            // Obtener los detalles del cliente de los campos de entrada
            const customerNameInput = document.getElementById('customer-name');
            const customerAddressInput = document.getElementById('customer-address');
            const customerPhoneInput = document.getElementById('customer-phone-order');

            const customerName = customerNameInput ? customerNameInput.value.trim() : '';
            const customerAddress = customerAddressInput ? customerAddressInput.value.trim() : '';
            const customerPhone = customerPhoneInput ? customerPhoneInput.value.trim() : '';
            
            // Obtener métodos de entrega y pago
            const deliveryMethod = getSelectedRadioValue('delivery-method');
            const paymentMethod = getSelectedRadioValue('payment-method');

            let allFieldsValid = true;

            // Validación básica
            if (!customerName) { customerNameInput?.classList.add('border-red-500'); allFieldsValid = false; } else { customerNameInput?.classList.remove('border-red-500'); }
            // Validación básica del teléfono (al menos 7 dígitos, ajustar regex si es necesario para formatos específicos)
            if (!customerPhone || !/^\d{7,}$/.test(customerPhone)) { 
                customerPhoneInput?.classList.add('border-red-500'); allFieldsValid = false; 
            } else { 
                customerPhoneInput?.classList.remove('border-red-500'); 
            }
            
            if (!deliveryMethod) { 
                document.querySelectorAll('input[name="delivery-method"]').forEach(el => el.closest('label').classList.add('text-red-500'));
                allFieldsValid = false; 
            } else {
                document.querySelectorAll('input[name="delivery-method"]').forEach(el => el.closest('label').classList.remove('text-red-500'));
            }

            // Solo validar la dirección si se selecciona la entrega a domicilio
            if (deliveryMethod === "A Domicilio" && customerAddress === '') {
                customerAddressInput?.classList.add('border-red-500'); allFieldsValid = false; 
            } else {
                customerAddressInput?.classList.remove('border-red-500');
            }

            if (!paymentMethod) { 
                document.querySelectorAll('input[name="payment-method"]').forEach(el => el.closest('label').classList.add('text-red-500'));
                allFieldsValid = false; 
            } else {
                document.querySelectorAll('input[name="payment-method"]').forEach(el => el.closest('label').classList.remove('text-red-500'));
            }

            if (!allFieldsValid) {
                showModal(lang.requiredFields, lang.completeYourDetails);
                console.warn("Pago abortado: Falló la validación.");
                return;
            }

            // Recalcular los totales una última vez antes de enviar
            const { subtotal, discount, shippingCost, total } = calculateCartTotals();
            console.log("Pago: Totales para el mensaje de WhatsApp:", { subtotal, discount, shippingCost, total });

            let whatsappMessage = `¡Hola! Me gustaría hacer un pedido de R&F Productos Integrales.\n\n`;
            whatsappMessage += `*--- Datos del Cliente ---*\n`;
            whatsappMessage += `🙋 *Nombre:* ${customerName}\n`;
            whatsappMessage += `📞 *Teléfono:* ${customerPhone}\n`;
            whatsappMessage += `📍 *Dirección:* ${deliveryMethod === "A Domicilio" ? customerAddress : "Recoger en Tienda"}\n`;
            whatsappMessage += `🚚 *Método de Entrega:* ${deliveryMethod}\n`;
            whatsappMessage += `💰 *Método de Pago:* ${paymentMethod}\n`;
            if (paymentMethod === "Transferencia Bancaria") {
                // Obtener la cuenta bancaria seleccionada si está disponible
                const selectedAccountElement = document.getElementById("cuentas"); // Asegúrese de que este ID exista si desea seleccionar de un desplegable de cuentas
                const selectedAccount = selectedAccountElement ? selectedAccountElement.value : lang.bankPopular; // Por defecto a Popular si no se selecciona o falta el elemento
                whatsappMessage += `🏦 *Cuenta de Transferencia:* ${selectedAccount}\n`;
            }
            const customerComment = document.getElementById('comentario')?.value.trim();
            if (customerComment) {
                whatsappMessage += `✏️ *Nota:* ${customerComment}\n`;
            }
            whatsappMessage += `\n*--- Detalles del Pedido ---*\n`;
            
            cart.forEach(item => {
                const product = products.find(p => p.id === item.productId);
                if (product) {
                    // Usar item.pricePerUnit que se calculó cuando se actualizó la cantidad
                    whatsappMessage += `- ${product.name} x${item.quantity} (RD$${item.pricePerUnit.toFixed(2)} c/u)\n`;
                }
            });

            whatsappMessage += `\n*🧾 ${translations[currentLanguage].subtotal}* ${formatPrice(subtotal)}`;
            whatsappMessage += `\n*🎁 ${translations[currentLanguage].discount}* -${formatPrice(discount)}`;
            whatsappMessage += `\n*🚚 ${translations[currentLanguage].shippingCost}* +${formatPrice(shippingCost)}`;
            whatsappMessage += `\n*💳 ${translations[currentLanguage].total}* ${formatPrice(total)}`;
            whatsappMessage += `\n\n*Nota Importante sobre Descuentos:*\n${lang.discountNote}\n\n`; // Agregar nota de descuento al mensaje de WhatsApp

            whatsappMessage += `Por favor, envíame los detalles para completar la compra. ¡Gracias!`;

            // Codificar el mensaje para una URL
            const encodedMessage = encodeURIComponent(whatsappMessage);
            const whatsappNumber = '18094254540'; // Código de República Dominicana + número de la tienda
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

            // Abrir WhatsApp en una nueva pestaña
            window.open(whatsappUrl, '_blank');
            console.log("URL de WhatsApp abierta:", whatsappUrl);

            // Borrar el carrito después de generar el mensaje del pedido
            cart = [];
            saveCart();
            updateCartCount();
            // Mostrar un modal de confirmación y luego navegar a la página de inicio
            showModal(lang.orderSent, lang.orderSentMessage);
            // Después de enviar, borrar los campos de entrada y restablecer los botones de radio
            if (customerNameInput) customerNameInput.value = '';
            if (customerAddressInput) customerAddressInput.value = '';
            if (customerPhoneInput) customerPhoneInput.value = '';
            document.querySelectorAll('input[name="delivery-method"]').forEach(el => el.checked = false);
            document.querySelectorAll('input[name="payment-method"]').forEach(el => el.checked = false);
            toggleBankDetails(); // Ocultar los detalles bancarios después de restablecer

            setTimeout(() => navigateTo('home', null, event), 3000); // Navegar a la página de inicio después de 3 segundos
        };


        // --- Navegación y enrutamiento ---

        /**
         * Navega a una página especificada y actualiza el hash de la URL.
         * Esta función maneja la configuración del hash y el renderizado directo de la página.
         * @param {string} page - El nombre de la página a la que navegar (ej., 'home', 'shop', 'product', 'cart', 'about-us', 'disease', 'combo', 'blog-post').
         * @param {string} [param=null] - Un parámetro opcional para la página (ej., ID de producto para la página 'product').
         * @param {Event} [event=null] - El objeto de evento, si se llama desde un controlador de eventos (ej., click).
         */
        const navigateTo = (page, param = null, event = null) => {
            if (event) {
                event.preventDefault(); // Crucial: Detener el comportamiento de enlace predeterminado
            }
            console.log(`Navegando a la página: ${page} con parámetro: ${param}`);
            const newHash = page + (param ? `-${param}` : '');
            
            // Solo actualizar el hash si es diferente para evitar entradas de historial innecesarias
            if (window.location.hash.substring(1) !== newHash) {
                window.location.hash = newHash;
            }
            
            // Siempre renderizar la página directamente después de establecer el hash (o si el hash ya está establecido)
            renderPage(page, param);
        };

        /**
         * Renderiza el contenido de la página actual en función de su nombre y parámetro opcional.
         * Esta función debe ser el ÚNICO punto de entrada para renderizar contenido basado en la navegación.
         * @param {string} page - El nombre de la página a renderizar.
         * @param {string} [param=null] - Un parámetro opcional para la página.
         */
        const renderPage = (page, param = null) => {
            console.log(`Renderizando página: ${page}`);
            currentPage = page; // Mantener un registro de la página actual
            // Borrar cualquier intervalo de carrusel activo al navegar fuera de la página de inicio
            if (page !== 'home') {
                clearInterval(carouselInterval);
            }
            switch (page) {
                case 'home':
                    renderHome();
                    break;
                case 'shop':
                    renderShop(); // Los filtros serán aplicados por applyFiltersAndSort
                    break;
                case 'product':
                    renderProductDetail(param);
                    break;
                case 'cart':
                    renderCartPage(); // Usar la función de carrito renombrada
                    break;
                case 'offers':
                    renderOffers();
                    break;
                case 'about-us':
                    renderAboutUs();
                    break;
                case 'enfermedades-soluciones':
                    renderEnfermedadesSoluciones();
                    break;
                case 'disease': // Nuevo caso para la página de detalles de la enfermedad
                    renderDiseaseDetail(param);
                    break;
                case 'contact':
                    renderContact();
                    break;
                case 'blog':
                    renderBlog();
                    break;
                case 'blog-post': // NUEVO: Caso para el detalle de la publicación del blog
                    renderBlogPost(param);
                    break;
                case 'payment-methods':
                    renderPaymentMethods();
                    break;
                case 'login':
                    renderLogin();
                    break;
                case 'register':
                    renderRegister();
                    break;
                case 'my-account':
                    renderMyAccount();
                    break;
                case 'my-orders': // NUEVO
                    renderMyOrders();
                    break;
                case 'my-info': // NUEVO
                    renderMyInfo();
                    break;
                case 'my-addresses': // NUEVO
                    renderMyAddresses();
                    break;
                case 'combo': // Nuevo caso para la página de detalles del combo
                    renderComboDetail(param);
                    break;
                default:
                    renderHome(); // Volver a la página de inicio
            }
            // Asegurar que el campo de búsqueda se borre/reinicie al navegar fuera de la tienda/resultados de búsqueda
            if (searchInput && page !== 'shop') { // Añadir comprobación
                searchInput.value = '';
            }
            console.log(`Página ${page} renderizada.`);
        };

        /**
         * Rellena el menú desplegable de la tienda con categorías y subcategorías dinámicas.
         */
        const populateCategoryMenu = () => {
            const shopDropdown = document.querySelector('nav .group div');
            if (!shopDropdown) return; // Cláusula de guardia en caso de que el elemento no esté disponible o se elimine

            shopDropdown.innerHTML = ''; // Borrar contenido existente

            const categories = getUniqueCategories();
            categories.forEach(category => {
                const categoryLink = document.createElement('a');
                categoryLink.href = `#shop`;
                categoryLink.textContent = category;
                categoryLink.classList.add('block', 'px-4', 'py-2', 'text-sm', 'text-gray-700', 'hover:bg-gray-100', 'rounded-md');
                categoryLink.onclick = (e) => {
                    e.preventDefault(); // Mantener esto ya que es un controlador de clics de elementos dinámicos
                    navigateTo('shop'); // navigateTo establece el hash Y activa renderPage
                    // No se necesita setTimeout aquí, ya que navigateTo ahora llama a renderPage directamente
                    applyFiltersAndSort({ category: category }); 
                };
                shopDropdown.appendChild(categoryLink);

                const subcategories = getUniqueSubcategories(category);
                if (subcategories.length > 0) {
                    const subcategoryDiv = document.createElement('div');
                    subcategoryDiv.classList.add('ml-4', 'border-l', 'border-gray-200', 'pl-2', 'py-1');
                    subcategories.forEach(sub => {
                        const subLink = document.createElement('a');
                        subLink.href = `#shop`;
                        subLink.textContent = `- ${sub}`;
                        subLink.classList.add('block', 'px-4', 'py-1', 'text-xs', 'text-gray-600', 'hover:bg-gray-50', 'rounded-md');
                        subLink.onclick = (e) => {
                            e.preventDefault(); // Mantener esto para elementos dinámicos
                            navigateTo('shop');
                            // No se necesita setTimeout aquí, ya que navigateTo ahora llama a renderPage directamente
                            applyFiltersAndSort({ category: category, subcategory: sub });
                        };
                        subcategoryDiv.appendChild(subLink);
                    });
                    shopDropdown.appendChild(subcategoryDiv);
                }
            });
        };

        /**
         * Aplica filtros y clasificación a la página de la tienda.
         * Esta función lee las selecciones actuales de filtro/clasificación del DOM y llama a renderShop.
         * @param {Object} [additionalFilter={}] - Parámetros de filtro adicionales opcionales (ej., de enlaces de categoría).
         */
        const applyFiltersAndSort = (additionalFilter = {}) => {
            const brandFilter = document.getElementById('filter-brand')?.value || '';
            const categoryFilter = document.getElementById('filter-category')?.value || '';
            const benefitFilter = document.getElementById('filter-benefit')?.value || '';
            const certificationFilter = document.getElementById('filter-certification')?.value || '';
            const minPriceFilter = parseFloat(document.getElementById('filter-price-min')?.value) || undefined;
            const maxPriceFilter = parseFloat(document.getElementById('filter-price-max')?.value) || undefined;
            const sortOption = document.getElementById('sort-options')?.value || 'relevance';

            // Combinar filtros de la UI y cualquier filtro adicional
            const currentFilters = {
                brand: brandFilter,
                category: categoryFilter,
                benefit: benefitFilter,
                certification: certificationFilter,
                minPrice: minPriceFilter,
                maxPrice: maxPriceFilter,
                ...additionalFilter // Esto permite pasar un filtro específico como { isOffer: true }
            };
            renderShop(currentFilters, sortOption);
        };


        // --- Oyentes de eventos y configuración inicial ---

        // Oyente de eventos para cambios de hash en la URL (para navegación)
        window.addEventListener('hashchange', () => {
            const hash = window.location.hash.substring(1);
            const parts = hash.split('-');
            const page = parts[0];
            const param = parts.slice(1).join('-'); // Reconstruir el parámetro si contiene guiones
            console.log(`Cambio de hash detectado: página=${page}, parámetro=${param}`);
            // Solo renderizar si el hash realmente ha cambiado de la currentPage para evitar doble renderizado
            // Esto es importante si navigateTo ya llamó a renderPage para el mismo hash.
            // Para simplificar, confiamos en que navigateTo siempre llame a renderPage directamente,
            // y este oyente de hashchange maneja principalmente los clics de los botones de retroceso/avance o la entrada directa de URL.
            // Si la currentPage interna actual es diferente del hash, entonces renderizar.
            if (currentPage !== page || (param && currentPage === page && window.location.hash.substring(1) !== `${page}-${param}`)) {
                 renderPage(page, param);
            } else if (!param && currentPage === page && window.location.hash.substring(1) !== page) {
                renderPage(page, param);
            }
           
        });

        // DOMContentLoaded asegura que todo el HTML se analice antes de ejecutar el script
        document.addEventListener('DOMContentLoaded', () => {
            // Seleccionar elementos del DOM después de que el DOM esté completamente cargado
            appContent = document.getElementById('app-content');
            cartCountElement = document.getElementById('cart-count');
            cartModal = document.getElementById('cart-modal');
            searchInput = document.getElementById('search-input');


            updateCartCount(); // Actualizar el contador del carrito al cargar
            populateCategoryMenu(); // Rellenar el menú de categorías dinámicas
            updateContentLanguage(); // Aplicar el idioma inicial a todos los elementos traducibles
            // Renderizar la página inicial en función del hash o por defecto a la página de inicio en la primera carga
            const initialHash = window.location.hash.substring(1);
            const initialParts = initialHash.split('-');
            const initialPage = initialParts[0] || 'home';
            const initialParam = initialParts.slice(1).join('-');
            renderPage(initialPage, initialParam);
            console.log("DOMContentLoaded: Página inicial renderizada.");

            // Oyente de eventos para el botón de búsqueda
            if (document.getElementById('search-button')) { // Añadir comprobación
                document.getElementById('search-button').addEventListener('click', (event) => {
                    const searchQuery = searchInput.value;
                    console.log(`Botón de búsqueda clicado. Consulta: ${searchQuery}`);
                    // Navegar a la tienda independientemente de la consulta de búsqueda para mostrar siempre la tienda con posibles filtros
                    navigateTo('shop', null, event); 
                    // Aplicar el filtro de búsqueda inmediatamente después de iniciar la navegación
                    setTimeout(() => applyFiltersAndSort({ searchQuery: searchQuery }), 0); // Usar setTimeout para asegurar que el DOM esté listo
                });
            }

            // Oyente de eventos para la tecla Enter en el campo de búsqueda
            if (searchInput) { // Añadir comprobación
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const searchQuery = searchInput.value;
                        console.log(`Tecla Enter presionada en el campo de búsqueda. Consulta: ${searchQuery}`);
                        navigateTo('shop', null, e); // Navegar y activar renderizado
                        setTimeout(() => applyFiltersAndSort({ searchQuery: searchQuery }), 0); // Aplicar filtro
                    }
                });
            }
        });
    </script>
</head>
<body class="flex flex-col min-h-screen">
    <!-- Sección de encabezado -->
    <header class="bg-white shadow-md py-4">
        <!-- Banner promocional superior -->
        <div id="promo-banner" class="bg-primary text-white text-center py-2 text-sm">
            La Naturaleza tiene sus metodos para curarte | Entrega en 24/48 horas | Confianza y pago seguro
        </div>
        <div class="container mx-auto px-4 flex items-center justify-between flex-wrap">
            <!-- Logo -->
            <a href="#home" class="flex items-center space-x-2 mr-6" onclick="navigateTo('home', null, event)">
                <!-- Reemplace './images/logo.jpg' con la ruta relativa real del logotipo de su tienda -->
                <img src="./images/logo.jpg" alt="Logo R&F Productos Integrales" class="rounded-full w-10 h-10 object-contain">
                <span class="text-2xl font-bold text-primary">R&F Productos Integrales</span>
            </a>

            <!-- Barra de búsqueda -->
            <div class="flex-grow max-w-lg mx-auto order-last md:order-none w-full md:w-auto mt-4 md:mt-0">
                <div class="relative flex items-center w-full">
                    <input type="text" id="search-input" placeholder="Buscar productos..."
                           class="w-full pl-4 pr-10 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-primary">
                    <button id="search-button" class="absolute right-0 top-0 mt-0.5 mr-1.5 flex items-center justify-center p-2 rounded-full bg-primary text-white hover:bg-green-700 transition duration-200">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <!-- Íconos/Enlaces de utilidad (Carrito, Cuenta) -->
            <div class="flex items-center space-x-4 ml-auto">
                <!-- Enlace al carrito -->
                <a href="#cart" id="cart-link" class="relative p-2 text-gray-600 hover:text-primary transition duration-200" onclick="navigateTo('cart', null, event)">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </a>
                <!-- Menú desplegable de cuenta -->
                <div class="relative group">
                    <a href="#" class="p-2 text-gray-600 hover:text-primary transition duration-200">
                        <i class="fas fa-user-circle text-xl"></i>
                    </a>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
                        <a href="#my-account" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="navigateTo('my-account', null, event)">Mi Cuenta</a>
                        <a href="#login" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="navigateTo('login', null, event)">Iniciar Sesión</a>
                        <a href="#register" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="navigateTo('register', null, event)">Registrarse</a>
                    </div>
                </div>
            </div>
            <!-- Información de contacto (oculta en pantallas pequeñas, visible en medianas y grandes) -->
            <div class="hidden md:flex items-center space-x-2 ml-4">
                <i class="fab fa-whatsapp text-primary text-lg"></i>
                <!-- Actualizado: Texto y enlace a WhatsApp -->
                <a href="https://wa.me/18094254540" target="_blank" class="text-gray-600 text-sm hover:text-primary transition duration-200" data-translate="phoneLabel">Escríbenos: 809-425-4540</a>
            </div>
        </div>
        <!-- Navegación principal -->
        <nav class="bg-gray-100 py-3 mt-4 shadow-sm">
            <div class="container mx-auto px-4">
                <ul class="flex justify-center space-x-8 text-gray-700 font-medium text-lg flex-wrap">
                    <li><a href="#home" class="hover:text-primary transition duration-200" onclick="navigateTo('home', null, event)">Inicio</a></li>
                    <li class="relative group">
                        <a href="#shop" class="hover:text-primary transition duration-200 inline-flex items-center" onclick="navigateTo('shop', null, event)">
                            Tienda <i class="fas fa-chevron-down text-xs ml-1"></i>
                        </a>
                        <div class="absolute left-0 mt-2 w-60 bg-white rounded-md shadow-lg py-1 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
                            <!-- Categorías pobladas dinámicamente aquí -->
                        </div>
                    </li>
                    <li><a href="#offers" class="hover:text-primary transition duration-200" onclick="navigateTo('offers', null, event)">Ofertas</a></li>
                    <li><a href="#enfermedades-soluciones" class="hover:text-primary transition duration-200" onclick="navigateTo('enfermedades-soluciones', null, event)">Enfermedades y Soluciones</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Área de contenido principal -->
    <main id="app-content" class="flex-grow container mx-auto px-4 py-8">
        <!-- El contenido se cargará dinámicamente aquí mediante JavaScript -->
    </main>

    <!-- Sección de pie de página -->
    <footer class="bg-gray-800 text-white py-10 mt-8">
        <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <div class="lg:col-span-2">
                <h4 class="text-lg font-semibold mb-4 text-primary">Atención al Cliente</h4>
                <ul class="space-y-2 text-sm text-gray-300">
                    <li><a href="#about-us" onclick="navigateTo('about-us', null, event)" class="hover:text-white transition duration-200">Sobre Nosotros</a></li>
                    <li><a href="#contact" onclick="navigateTo('contact', null, event)" class="hover:text-white transition duration-200">Contacto</a></li>
                    <li><a href="#blog" onclick="navigateTo('blog', null, event)" class="hover:text-white transition duration-200">Blog</a></li>
                    <li><a href="#payment-methods" onclick="navigateTo('payment-methods', null, event)" class="hover:text-white transition duration-200">Métodos de Pago</a></li>
                </ul>
            </div>
            
            <div class="lg:col-span-2">
                <h4 class="text-lg font-semibold mb-2 text-primary">Síguenos</h4>
                <div class="flex space-x-4 mb-4">
                    <a href="#" class="text-gray-300 hover:text-white text-2xl transition duration-200"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="text-gray-300 hover:text-white text-2xl transition duration-200"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-gray-300 hover:text-white text-2xl transition duration-200"><i class="fab fa-youtube"></i></a>
                    <a href="#" class="text-gray-300 hover:text-white text-2xl transition duration-200"><i class="fab fa-tiktok"></i></a>
                </div>
                <h4 class="text-lg font-semibold mb-2 text-primary">Newsletter</h4>
                <form action="#" class="flex">
                    <input type="email" placeholder="Tu correo electrónico" class="p-2 rounded-l-md focus:outline-none focus:ring-2 focus:ring-primary text-gray-900 w-full">
                    <button type="submit" class="bg-primary text-white p-2 rounded-r-md hover:bg-green-700 transition duration-200">
                        Suscribir
                    </button>
                </form>
            </div>
        </div>
        <div class="container mx-auto px-4 text-center text-sm text-gray-400 mt-8 border-t border-gray-700 pt-6">
            <p>&copy; 2025 R&F Productos Integrales. Todos los derechos reservados.</p>
            <p class="mt-2 text-xs">
                Descargo de Responsabilidad: La información en este sitio no reemplaza el consejo médico. Los productos no están destinados a diagnosticar, tratar, curar o prevenir enfermedades. Consultar a un médico para dosis y frecuencia.
            </p>
        </div>
    </footer>

    <!-- Modal de confirmación del carrito -->
    <div id="cart-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
            <h3 class="text-xl font-semibold mb-4" id="modal-title">Producto Añadido al Carrito</h3>
            <p class="text-gray-700 mb-6" id="modal-message">¡El producto ha sido añadido exitosamente a tu carrito de compras!</p>
            <button onclick="closeModal()" class="px-6 py-2 bg-primary text-white rounded-md hover:bg-green-700 transition duration-200">Cerrar</button>
        </div>
    </div>
</body>
</html>
